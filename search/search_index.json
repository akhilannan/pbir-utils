{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"PBIR Utils","text":"<p>pbir-utils is a Python library designed to streamline the tasks that Power BI developers typically handle manually in Power BI Desktop. This module offers a range of utility functions to efficiently manage and manipulate PBIR (Power BI Enhanced Report Format) metadata.</p>"},{"location":"#features","title":"\u2728 Features","text":""},{"location":"#core-utilities","title":"Core Utilities","text":"<ul> <li>\ud83c\udf10 Web UI: Interactive browser-based interface for reports, wireframes, and actions</li> <li>\ud83d\udcc4 Extract Metadata: Export metadata from PBIR files to CSV</li> <li>\ud83d\uddbc\ufe0f Wireframe Visualizer: Visual report layout with zoom, search, and field tracking</li> <li>\u2705 Validate Report: Rule-based validation with custom expression support</li> <li>\ud83e\uddf9 Sanitize Report: Clean up and optimize reports with YAML configuration</li> </ul>"},{"location":"#report-management","title":"Report Management","text":"<ul> <li>\u26d4 Disable Interactions: Bulk disable interactions between visuals</li> <li>\ud83e\uddfc Remove Measures: Remove unused report-level measures</li> <li>\ud83d\udd17 Measure Dependencies: Extract measure dependency trees</li> <li>\ud83d\udd16 Remove Unused Bookmarks: Clean up orphaned bookmarks</li> <li>\ud83c\udfa8 Remove Unused Visuals: Remove unused custom visual registrations</li> </ul>"},{"location":"#filters-pages","title":"Filters &amp; Pages","text":"<ul> <li>\ud83d\udd0d Update Filters: Modify report-level filter conditions</li> <li>\ud83d\udd22 Sort Filters: Reorder filter pane items</li> <li>\u2699\ufe0f Configure Filter Pane: Control pane visibility and state</li> <li>\ud83d\udccf Set Page Size: Set page dimensions for all pages</li> <li>\ud83d\ude48 Hide Tooltip Pages: Auto-hide tooltip and drillthrough pages</li> </ul>"},{"location":"#installation","title":"\ud83d\udce6 Installation","text":"<pre><code># Using uv (Recommended)\nuv add pbir-utils\n\n# Using pip\npip install pbir-utils\n</code></pre> <p>For the web UI, install with optional dependencies:</p> <pre><code># Using uv\nuv add \"pbir-utils[ui]\"\n\n# Using pip\npip install \"pbir-utils[ui]\"\n</code></pre>"},{"location":"#quick-start","title":"\ud83d\ude80 Quick Start","text":"<p>After installation, the <code>pbir-utils</code> CLI is available:</p> <pre><code># Launch interactive web UI\npbir-utils ui\n\n# Sanitize a report with default actions (dry-run to preview)\npbir-utils sanitize \"C:\\Reports\\MyReport.Report\" --dry-run\n\n# Validate against best practices\npbir-utils validate \"C:\\Reports\\MyReport.Report\"\n\n# Extract metadata to CSV\npbir-utils extract-metadata \"C:\\Reports\\MyReport.Report\"\n\n# Visualize report wireframes\npbir-utils visualize \"C:\\Reports\\MyReport.Report\"\n</code></pre> <p>Or use the Python API:</p> <pre><code>import pbir_utils as pbir\n\n# Validate a report\nresult = pbir.validate_report(r\"C:\\Reports\\MyReport.Report\", strict=False)\nprint(result)  # \"5 passed, 0 errors, 2 warnings\"\n\n# Sanitize a report\npbir.sanitize_powerbi_report(r\"C:\\Reports\\MyReport.Report\", dry_run=True)\n</code></pre>"},{"location":"#next-steps","title":"\ud83d\udcda Next Steps","text":"<ul> <li>UI Guide - Web interface documentation</li> <li>CLI Reference - Detailed command-line usage</li> <li>Python API - Python library documentation</li> <li>CI/CD Integration - Pipeline integration and validation</li> </ul>"},{"location":"api/","title":"Python API","text":"<p>The <code>pbir_utils</code> library provides a comprehensive Python API for programmatic access to all utilities.</p> <pre><code>import pbir_utils as pbir\n</code></pre>"},{"location":"api/#sanitize-power-bi-report","title":"Sanitize Power BI Report","text":"<p>A powerful utility to clean up and optimize Power BI reports.</p>"},{"location":"api/#parameters","title":"Parameters","text":"Parameter Type Description <code>report_path</code> str Path to the report folder <code>actions</code> list Sanitization actions to perform <code>dry_run</code> bool Simulate changes without modifying files <code>summary</code> bool Show summary instead of detailed messages. Default: <code>False</code>"},{"location":"api/#available-actions","title":"Available Actions","text":"<p>Please refer to the CLI Reference for the complete list of available sanitization actions and their descriptions.</p> <p>Additional Actions via YAML</p> <p>More actions are available through YAML configuration, including <code>set_page_size_16_9</code>, <code>expand_filter_pane</code>, <code>collapse_filter_pane</code>, <code>hide_filter_pane</code>, <code>sort_filters_ascending</code>, <code>clear_all_report_filters</code>, and display option actions. See the CLI Reference for configuration details.</p>"},{"location":"api/#example","title":"Example","text":"<pre><code>pbir.sanitize_powerbi_report(\n    r\"C:\\DEV\\MyReport.Report\",\n    [\n        \"cleanup_invalid_bookmarks\",\n        \"remove_unused_measures\",\n        \"remove_unused_bookmarks\",\n        \"remove_unused_custom_visuals\",\n        \"disable_show_items_with_no_data\",\n        \"hide_tooltip_pages\",\n        \"set_first_page_as_active\",\n        \"remove_empty_pages\",\n        \"remove_hidden_visuals_never_shown\",\n        \"standardize_pbir_folders\",\n    ],\n    dry_run=True,\n)\n</code></pre>"},{"location":"api/#individual-sanitization-functions","title":"Individual Sanitization Functions","text":"<p>You can also call specific sanitization actions independently:</p> <pre><code># Remove unused bookmarks\npbir.remove_unused_bookmarks(report_path, dry_run=True)\n\n# Remove hidden visuals\npbir.remove_hidden_visuals_never_shown(report_path, dry_run=True)\n\n# Set first page as active\npbir.set_first_page_as_active(report_path, dry_run=True)\n\n# Remove empty pages\npbir.remove_empty_pages(report_path, dry_run=True)\n\n# Cleanup invalid bookmarks\npbir.cleanup_invalid_bookmarks(report_path, dry_run=True)\n\n# Standardize folder names\npbir.standardize_pbir_folders(report_path, dry_run=True)\n\n# Set page display option\npbir.set_page_display_option(report_path, display_option=\"FitToPage\", dry_run=True)\n</code></pre> <p>Backup Your Reports</p> <p>Always backup your report or use version control before running sanitization. Some actions are irreversible. Use <code>dry_run=True</code> to preview changes.</p>"},{"location":"api/#validate-report","title":"Validate Report","text":"<p>Validates a Power BI report against configurable checks. By default, runs both sanitizer checks and expression rules.</p>"},{"location":"api/#parameters_1","title":"Parameters","text":"Parameter Type Description <code>report_path</code> str Path to the report folder <code>source</code> str Which checks to run: <code>\"all\"</code> (default), <code>\"sanitize\"</code>, or <code>\"rules\"</code> <code>actions</code> list Specific sanitizer action IDs to check (from <code>pbir-sanitize.yaml</code>) <code>rules</code> list Specific expression rule IDs to run (from <code>pbir-rules.yaml</code>) <code>sanitize_config</code> str/Path Custom sanitize config path (default: auto-discovered) <code>rules_config</code> str/Path Custom rules config path (default: auto-discovered) <code>severity</code> str Minimum severity to check (<code>info</code>, <code>warning</code>, <code>error</code>) <code>strict</code> bool Raise exception on error violations. Default: <code>True</code>"},{"location":"api/#returns","title":"Returns","text":"<p><code>ValidationResult</code> object with:</p> Property Type Description <code>passed</code> int Number of rules that passed <code>failed</code> int Number of rules that failed <code>error_count</code> int Failed rules with <code>severity=error</code> <code>warning_count</code> int Failed rules with <code>severity=warning</code> <code>info_count</code> int Failed rules with <code>severity=info</code> <code>has_errors</code> bool <code>True</code> if any error-severity rules failed <code>has_warnings</code> bool <code>True</code> if any warning-severity rules failed <code>failed_rules</code> dict Failed rules as <code>{rule_id: rule_name}</code> <code>results</code> dict Rule ID \u2192 passed (bool), e.g., <code>{\"remove_unused_measures\": False, ...}</code> <code>violations</code> list Full violation details (see below) <p>String representation: Converting to string (e.g., <code>print(validation_result)</code>) returns a summary like <code>\"5 passed, 0 errors, 2 warnings, 1 info\"</code>. Counts are at the rule level, not individual violation instances.</p> <p>Each violation in <code>violations</code> is a dict with:</p> Key Description <code>rule_id</code> Rule identifier (e.g., <code>\"remove_unused_measures\"</code>) <code>rule_name</code> Human-readable rule name <code>severity</code> <code>\"error\"</code>, <code>\"warning\"</code>, or <code>\"info\"</code> <code>message</code> Violation detail message <code>page_name</code> (scope=page/visual) Page display name <code>visual_name</code> (scope=visual) Visual ID <code>visual_type</code> (scope=visual) Visual type <code>measure_name</code> (scope=measure) Measure name <code>entity_name</code> (scope=measure) Entity name <code>bookmark_name</code> (scope=bookmark) Bookmark name"},{"location":"api/#raises","title":"Raises","text":"<ul> <li><code>ValidationError</code>: If <code>strict=True</code> and any error violations found (or warnings if <code>fail_on_warning: true</code> in config).</li> </ul>"},{"location":"api/#example_1","title":"Example","text":"<pre><code>from pbir_utils import validate_report, ValidationError\n\n# Run all checks (default)\nresult = validate_report(r\"C:\\Reports\\MyReport.Report\", strict=False)\nprint(result)  # \"5 passed, 0 errors, 9 warnings, 3 info\"\n\n# Run only sanitizer checks\nresult = validate_report(\n    r\"C:\\Reports\\MyReport.Report\",\n    source=\"sanitize\",\n    strict=False\n)\n\n# Run only expression rules\nresult = validate_report(\n    r\"C:\\Reports\\MyReport.Report\",\n    source=\"rules\",\n    strict=False\n)\n\n# Run specific sanitizer actions only\nresult = validate_report(\n    r\"C:\\Reports\\MyReport.Report\",\n    actions=[\"remove_unused_measures\", \"cleanup_invalid_bookmarks\"],\n    strict=False\n)\n\n# Run specific expression rules only\nresult = validate_report(\n    r\"C:\\Reports\\MyReport.Report\",\n    rules=[\"reduce_pages\", \"reduce_visuals_on_page\"],\n    strict=False\n)\n\n# Filter by minimum severity\nresult = validate_report(\n    r\"C:\\Reports\\MyReport.Report\",\n    severity=\"warning\",  # Only warning and error\n    strict=False\n)\n\n# Use custom config files\nresult = validate_report(\n    r\"C:\\Reports\\MyReport.Report\",\n    sanitize_config=\"custom-sanitize.yaml\",\n    rules_config=\"custom-rules.yaml\",\n    strict=False\n)\n\n# Access counts directly\nif result.has_errors:\n    print(\"Build failed!\")\nprint(f\"Warnings: {result.warning_count}\")\n</code></pre>"},{"location":"api/#handling-validationerror","title":"Handling ValidationError","text":"<pre><code>from pbir_utils import validate_report, ValidationError\n\ntry:\n    result = validate_report(r\"C:\\Reports\\MyReport.Report\", strict=True)\nexcept ValidationError as e:\n    print(f\"Validation failed: {e}\")\n    for v in e.violations:\n        print(f\"  - {v['rule_id']}: {v['message']}\")\n</code></pre> <p>For configuration details, see Validate Report CLI Reference.</p>"},{"location":"api/#display-report-wireframes","title":"Display Report Wireframes","text":"<p>Generates a static HTML wireframe of the report layout and opens it in the default web browser.</p> <p>This function creates a temporary HTML file containing the wireframe visualization. The output includes rich interactive features: dark mode toggle, zoom controls (25%-200%), visual count badges, dimension tooltips, search/filter, copy ID, visual/page hiding with restoration pills, and global undo/reset.</p>"},{"location":"api/#parameters_2","title":"Parameters","text":"Parameter Type Description <code>report_path</code> str Path to the PBIR report folder <code>pages</code> list Page names to include (empty = all pages) <code>visual_types</code> list Visual types to include (empty = all types) <code>visual_ids</code> list Visual IDs to include (empty = all visuals) <code>show_hidden</code> bool Include hidden visuals in the output. Default: <code>True</code> <p>Filter Logic</p> <p>The <code>pages</code>, <code>visual_types</code>, and <code>visual_ids</code> parameters use AND logic. Only visuals matching all specified criteria are shown.</p>"},{"location":"api/#example_2","title":"Example","text":"<pre><code>pbir.display_report_wireframes(\n    report_path=r\"C:\\DEV\\MyReport.Report\",\n    pages=[\"Overview\"],\n    visual_types=[\"slicer\"],\n    show_hidden=True\n)\n</code></pre>"},{"location":"api/#export-metadata-to-csv","title":"Export Metadata to CSV","text":"<p>Exports metadata from PBIR into a CSV file. Supports two modes: attribute metadata (default) and visual metadata (<code>visuals_only=True</code>).</p>"},{"location":"api/#parameters_3","title":"Parameters","text":"Parameter Type Description <code>directory_path</code> str Path to the PBIR report folder or a parent directory containing multiple reports <code>csv_output_path</code> str Path for output CSV file. If not provided, defaults to <code>metadata.csv</code> or <code>visuals.csv</code> in the report folder <code>filters</code> dict [Deprecated] Dictionary to filter output. Prefer using explicit parameters below. <code>pages</code> list[str] Filter by page displayName(s) <code>reports</code> list[str] Filter by report name(s) when processing a directory <code>tables</code> list[str] Filter by table name(s) <code>visual_types</code> list[str] Filter by visual type(s) (for <code>visuals_only=True</code>) <code>visual_ids</code> list[str] Filter by visual ID(s) (for <code>visuals_only=True</code>) <code>visuals_only</code> bool If <code>True</code>, exports visual-level metadata instead of attribute usage. Default: <code>False</code>"},{"location":"api/#example_3","title":"Example","text":"<pre><code># Export attribute metadata with default output (metadata.csv in report folder)\npbir.export_pbir_metadata_to_csv(\n    directory_path=r\"C:\\DEV\\Power BI Report\",\n)\n\n# Export with page filter\npbir.export_pbir_metadata_to_csv(\n    directory_path=r\"C:\\DEV\\Power BI Report\",\n    csv_output_path=r\"C:\\DEV\\metadata.csv\",\n    pages=[\"Overview\", \"Detail\"],\n)\n\n# Export from directory, filtering by report names\npbir.export_pbir_metadata_to_csv(\n    directory_path=r\"C:\\DEV\\Reports\",\n    reports=[\"Report1\", \"Report2\"],\n)\n\n# Export visual metadata with visual type filter\npbir.export_pbir_metadata_to_csv(\n    directory_path=r\"C:\\DEV\\Power BI Report\",\n    visuals_only=True,\n    visual_types=[\"slicer\", \"card\"],\n)\n</code></pre>"},{"location":"api/#output-columns","title":"Output Columns","text":"<p>Attribute Metadata (default): Report, Page Name, Page ID, Table, Column or Measure, Expression, Used In, Used In Detail, ID</p> <p>Visual Metadata (<code>visuals_only=True</code>): Report, Page Name, Page ID, Visual Type, Visual ID, Parent Group ID, Is Hidden</p>"},{"location":"api/#batch-update-attributes","title":"Batch Update Attributes","text":"<p>Performs a batch update on all components of a PBIR project by processing JSON files. Updates table and column references based on mappings provided in a CSV file.</p>"},{"location":"api/#parameters_4","title":"Parameters","text":"Parameter Type Description <code>directory_path</code> str Path to the root directory of the PBIR project <code>csv_path</code> str Path to the <code>Attribute_Mapping.csv</code> file <code>dry_run</code> bool If <code>True</code>, simulate changes without modifying files. Default: <code>False</code>"},{"location":"api/#csv-format","title":"CSV Format","text":"<p>Please refer to the CLI Reference for the required CSV format and column definitions.</p>"},{"location":"api/#example_4","title":"Example","text":"<pre><code>pbir.batch_update_pbir_project(\n    directory_path=r\"C:\\DEV\\Power BI Report\",\n    csv_path=r\"C:\\DEV\\Attribute_Mapping.csv\",\n    dry_run=True\n)\n</code></pre>"},{"location":"api/#disable-visual-interactions","title":"Disable Visual Interactions","text":"<p>Disables interactions between visuals based on provided parameters.</p>"},{"location":"api/#parameters_5","title":"Parameters","text":"Parameter Type Description <code>report_path</code> str Path to the PBIR report folder <code>pages</code> list Page names to process (empty = all pages) <code>source_visual_ids</code> list Source visual IDs <code>source_visual_types</code> list Source visual types <code>target_visual_ids</code> list Target visual IDs <code>target_visual_types</code> list Target visual types <code>update_type</code> str <code>\"Upsert\"</code> (default), <code>\"Insert\"</code>, or <code>\"Overwrite\"</code> <code>dry_run</code> bool Simulate changes without modifying files <code>summary</code> bool Show summary instead of detailed messages. Default: <code>False</code>"},{"location":"api/#update-types","title":"Update Types","text":"<ul> <li>Upsert: Disables matching interactions and inserts new combinations. Unmatched interactions remain unchanged.</li> <li>Insert: Adds new interactions without modifying existing ones.</li> <li>Overwrite: Replaces all existing interactions with the new configuration.</li> </ul>"},{"location":"api/#behavior","title":"Behavior","text":"<p>The function's scope depends on which parameters are provided:</p> <ol> <li> <p>Only <code>report_path</code>: Disables interactions between all visuals across all pages.</p> </li> <li> <p><code>report_path</code> + <code>pages</code>: Disables interactions between all visuals on the specified pages only.</p> </li> <li> <p>With <code>source_visual_ids</code> or <code>source_visual_types</code>: Disables interactions from the specified source visuals to all other visuals (or specified targets) on the pages.</p> </li> <li> <p>With <code>target_visual_ids</code> or <code>target_visual_types</code>: Disables interactions to the specified target visuals from all source visuals (or specified sources) on the pages.</p> </li> </ol>"},{"location":"api/#example_5","title":"Example","text":"<pre><code>pbir.disable_visual_interactions(\n    report_path=r\"C:\\DEV\\MyReport.Report\",\n    pages=[\"Overview\"],\n    source_visual_types=[\"slicer\"],\n    update_type=\"Upsert\",\n    dry_run=True\n)\n</code></pre>"},{"location":"api/#remove-measures","title":"Remove Measures","text":"<p>Removes report-level measures from a Power BI report.</p>"},{"location":"api/#parameters_6","title":"Parameters","text":"Parameter Type Description <code>report_path</code> str Path to the report folder <code>measure_names</code> list Measures to remove (empty = all measures) <code>check_visual_usage</code> bool Only remove unused measures. Default: <code>True</code> <code>dry_run</code> bool Simulate changes without modifying files <code>summary</code> bool Show summary instead of detailed messages. Default: <code>False</code>"},{"location":"api/#example_6","title":"Example","text":"<pre><code>pbir.remove_measures(\n    report_path=r\"C:\\DEV\\MyReport.Report\",\n    measure_names=[\"Unused Measure 1\", \"Unused Measure 2\"],\n    check_visual_usage=True,\n    dry_run=True\n)\n</code></pre>"},{"location":"api/#generate-measure-dependencies","title":"Generate Measure Dependencies","text":"<p>Generates a dependency tree for measures, focusing on measures with dependencies.</p>"},{"location":"api/#parameters_7","title":"Parameters","text":"Parameter Type Description <code>report_path</code> str Path to the report folder <code>measure_names</code> list Measures to analyze (empty = all measures) <code>include_visual_ids</code> bool Include visual IDs using the measures"},{"location":"api/#example_7","title":"Example","text":"<pre><code>result = pbir.generate_measure_dependencies_report(\n    report_path=r\"C:\\DEV\\MyReport.Report\",\n    measure_names=[],\n    include_visual_ids=True\n)\nprint(result)\n</code></pre>"},{"location":"api/#update-report-filters","title":"Update Report Filters","text":"<p>Updates filters in the Power BI report level filter pane.</p>"},{"location":"api/#parameters_8","title":"Parameters","text":"Parameter Type Description <code>report_path</code> str Path to .Report folder or root directory containing reports <code>filters</code> list Filter configurations to apply <code>reports</code> list Specific reports to update (optional) <code>dry_run</code> bool Simulate changes without modifying files <code>summary</code> bool Show summary instead of detailed messages. Default: <code>False</code>"},{"location":"api/#condition-types-filter-values","title":"Condition Types &amp; Filter Values","text":"<p>Please refer to the CLI Reference for the full list of supported condition types and filter value formats.</p>"},{"location":"api/#example_8","title":"Example","text":"<pre><code>pbir.update_report_filters(\n    report_path=r\"C:\\DEV\\MyReport.Report\",\n    filters=[\n        # Inclusion filter\n        {\"Table\": \"Sales\", \"Column\": \"Region\", \"Condition\": \"In\", \"Values\": [\"North\", \"South\"]},\n        # Date range filter\n        {\"Table\": \"Orders\", \"Column\": \"OrderDate\", \"Condition\": \"Between\", \"Values\": [\"01-Jan-2023\", \"31-Dec-2023\"]},\n        # Numeric comparison\n        {\"Table\": \"Sales\", \"Column\": \"Amount\", \"Condition\": \"GreaterThan\", \"Values\": [100]},\n        # Text matching\n        {\"Table\": \"Products\", \"Column\": \"Name\", \"Condition\": \"Contains\", \"Values\": [\"Pro\"]},\n        # Clear existing filter\n        {\"Table\": \"Sales\", \"Column\": \"Category\", \"Condition\": \"In\", \"Values\": None},\n    ],\n    dry_run=True\n)\n</code></pre>"},{"location":"api/#sort-report-filters","title":"Sort Report Filters","text":"<p>Reorders filters in the report filter pane based on a sorting strategy.</p>"},{"location":"api/#parameters_9","title":"Parameters","text":"Parameter Type Description <code>report_path</code> str Path to .Report folder or root directory containing reports <code>reports</code> list Specific reports to update (optional) <code>sort_order</code> str Sorting strategy (see below) <code>custom_order</code> list Custom filter order (required for <code>Custom</code>) <code>dry_run</code> bool Simulate changes without modifying files <code>summary</code> bool Show summary instead of detailed messages. Default: <code>False</code>"},{"location":"api/#sorting-strategies","title":"Sorting Strategies","text":"Strategy Description <code>Ascending</code> Alphabetical order (A-Z) <code>Descending</code> Reverse alphabetical order (Z-A) <code>SelectedFilterTop</code> Selected filters first (both groups sorted ascending) <code>Custom</code> Order based on <code>custom_order</code> list"},{"location":"api/#example_9","title":"Example","text":"<pre><code>pbir.sort_report_filters(\n    report_path=r\"C:\\DEV\\MyReport.Report\",\n    sort_order=\"SelectedFilterTop\",\n    dry_run=True\n)\n</code></pre>"},{"location":"api/#clear-filters","title":"Clear Filters","text":"<p>Clears filter conditions from report, page, and visual levels. By default operates in dry-run mode (inspection only).</p>"},{"location":"api/#parameters_10","title":"Parameters","text":"Parameter Type Description <code>report_path</code> str Path to the PBIR report folder <code>show_page_filters</code> bool Include all page-level filters. Default: <code>False</code> <code>show_visual_filters</code> bool Include all visual-level filters. Default: <code>False</code> <code>target_page</code> str Target specific page by displayName or ID (optional) <code>target_visual</code> str Target specific visual by name or type (optional) <code>include_tables</code> list Table name patterns to match (supports wildcards) <code>include_columns</code> list Column name patterns to match (supports wildcards) <code>include_fields</code> list Full field references to match (e.g., <code>'Sales'[Amount]</code>) <code>clear_all</code> bool Explicitly clear all matching filters. Default: <code>False</code> <code>dry_run</code> bool Preview without modifying files. Default: <code>True</code> <code>summary</code> bool Show concise count-based summary instead of detailed messages. Default: <code>False</code> <p>Slicer Support</p> <p>The function automatically detects all slicer types including standard slicers (<code>slicer</code>), chiclet slicers (<code>chicletSlicer</code>), timeline slicers (<code>timelineSlicer</code>), and any custom slicer visuals containing \"slicer\" in the type name.</p>"},{"location":"api/#example_10","title":"Example","text":"<pre><code># Inspect report-level filters (dry run)\npbir.clear_filters(\n    report_path=r\"C:\\DEV\\MyReport.Report\",\n    dry_run=True\n)\n\n# Clear filters on Date tables\npbir.clear_filters(\n    report_path=r\"C:\\DEV\\MyReport.Report\",\n    include_tables=[\"Date*\"],\n    clear_all=True,\n    dry_run=False\n)\n\n# Clear page-level filters on a specific page\npbir.clear_filters(\n    report_path=r\"C:\\DEV\\MyReport.Report\",\n    target_page=\"Overview\",\n    clear_all=True,\n    dry_run=False\n)\n\n# Clear all visual filters including slicers with summary output\npbir.clear_filters(\n    report_path=r\"C:\\DEV\\MyReport.Report\",\n    show_visual_filters=True,\n    clear_all=True,\n    dry_run=False,\n    summary=True\n)\n</code></pre>"},{"location":"api/#configure-filter-pane","title":"Configure Filter Pane","text":"<p>Configures the filter pane visibility and expanded/collapsed state at the report level.</p>"},{"location":"api/#parameters_11","title":"Parameters","text":"Parameter Type Description <code>report_path</code> str Path to the PBIR report folder <code>visible</code> bool Show/hide the filter pane entirely. Default: <code>True</code> <code>expanded</code> bool Expand/collapse the pane when visible. Default: <code>False</code> <code>dry_run</code> bool Preview without modifying files. Default: <code>False</code> <code>summary</code> bool Show summary instead of detailed messages. Default: <code>False</code>"},{"location":"api/#example_11","title":"Example","text":"<pre><code># Hide the filter pane\npbir.configure_filter_pane(\n    report_path=r\"C:\\DEV\\MyReport.Report\",\n    visible=False,\n    dry_run=True\n)\n\n# Show filter pane expanded\npbir.configure_filter_pane(\n    report_path=r\"C:\\DEV\\MyReport.Report\",\n    visible=True,\n    expanded=True,\n    dry_run=False\n)\n\n# Show filter pane collapsed (default)\npbir.configure_filter_pane(\n    report_path=r\"C:\\DEV\\MyReport.Report\",\n    visible=True,\n    expanded=False\n)\n</code></pre>"},{"location":"api/#reset-filter-pane-width","title":"Reset Filter Pane Width","text":"<p>Resets the filter pane width by removing any custom width settings from all pages, reverting to the default width.</p>"},{"location":"api/#parameters_12","title":"Parameters","text":"Parameter Type Description <code>report_path</code> str Path to the PBIR report folder <code>dry_run</code> bool Preview without modifying files. Default: <code>False</code> <code>summary</code> bool Show summary instead of detailed messages. Default: <code>False</code>"},{"location":"api/#example_12","title":"Example","text":"<pre><code># Preview which pages have custom filter pane width\npbir.reset_filter_pane_width(\n    report_path=r\"C:\\DEV\\MyReport.Report\",\n    dry_run=True\n)\n\n# Reset filter pane width on all pages\npbir.reset_filter_pane_width(\n    report_path=r\"C:\\DEV\\MyReport.Report\",\n    dry_run=False\n)\n</code></pre>"},{"location":"api/#hide-pages-by-type","title":"Hide Pages by Type","text":"<p>Hides pages based on their type (Tooltip or Drillthrough).</p>"},{"location":"api/#parameters_13","title":"Parameters","text":"Parameter Type Description <code>report_path</code> str Path to the PBIR report folder <code>page_type</code> str Type of pages to hide (<code>Tooltip</code> or <code>Drillthrough</code>) <code>dry_run</code> bool Preview without modifying files. Default: <code>False</code> <code>summary</code> bool Show summary instead of detailed messages. Default: <code>False</code>"},{"location":"api/#example_13","title":"Example","text":"<pre><code># Hide all tooltip pages\npbir.hide_pages_by_type(\n    report_path=r\"C:\\DEV\\MyReport.Report\",\n    page_type=\"Tooltip\",\n    dry_run=True\n)\n\n# Hide all drillthrough pages\npbir.hide_pages_by_type(\n    report_path=r\"C:\\DEV\\MyReport.Report\",\n    page_type=\"Drillthrough\",\n    dry_run=False\n)\n</code></pre>"},{"location":"api/#set-page-display-option","title":"Set Page Display Option","text":"<p>Sets the display option for pages, controlling how pages are rendered in the Power BI viewer.</p>"},{"location":"api/#parameters_14","title":"Parameters","text":"Parameter Type Description <code>report_path</code> str Path to the PBIR report folder <code>display_option</code> str Display option to set (<code>ActualSize</code>, <code>FitToPage</code>, <code>FitToWidth</code>) <code>page</code> str Page name or displayName to filter (optional, None = all pages) <code>dry_run</code> bool Preview without modifying files. Default: <code>False</code> <code>summary</code> bool Show summary instead of detailed messages. Default: <code>False</code>"},{"location":"api/#display-options","title":"Display Options","text":"Option Description <code>ActualSize</code> Pages display at their actual pixel dimensions <code>FitToPage</code> Pages scale to fit the entire page in the viewport <code>FitToWidth</code> Pages scale to fit the width of the viewport"},{"location":"api/#example_14","title":"Example","text":"<pre><code># Set all pages to FitToPage\npbir.set_page_display_option(\n    report_path=r\"C:\\DEV\\MyReport.Report\",\n    display_option=\"FitToPage\",\n    dry_run=True\n)\n\n# Set a specific page by displayName\npbir.set_page_display_option(\n    report_path=r\"C:\\DEV\\MyReport.Report\",\n    display_option=\"ActualSize\",\n    page=\"Trends\",\n    dry_run=False\n)\n\n# Set a specific page by internal name/ID\npbir.set_page_display_option(\n    report_path=r\"C:\\DEV\\MyReport.Report\",\n    display_option=\"FitToWidth\",\n    page=\"bb40336091625ae0070a\"\n)\n</code></pre>"},{"location":"api/#set-page-size","title":"Set Page Size","text":"<p>Sets the page dimensions (width and height) for pages in the report.</p>"},{"location":"api/#parameters_15","title":"Parameters","text":"Parameter Type Description <code>report_path</code> str Path to the PBIR report folder <code>width</code> int Target page width in pixels. Default: <code>1280</code> <code>height</code> int Target page height in pixels. Default: <code>720</code> <code>exclude_tooltip</code> bool Skip tooltip pages. Default: <code>True</code> <code>dry_run</code> bool Preview without modifying files. Default: <code>False</code> <code>summary</code> bool Show summary instead of detailed messages. Default: <code>False</code>"},{"location":"api/#example_15","title":"Example","text":"<pre><code># Set all pages to 16:9 HD (1280x720)\npbir.set_page_size(\n    report_path=r\"C:\\DEV\\MyReport.Report\",\n    width=1280,\n    height=720,\n    dry_run=True\n)\n\n# Set pages to Full HD (1920x1080)\npbir.set_page_size(\n    report_path=r\"C:\\DEV\\MyReport.Report\",\n    width=1920,\n    height=1080,\n    exclude_tooltip=True,\n    dry_run=False\n)\n</code></pre>"},{"location":"ci_cd/","title":"CI/CD Integration","text":"<p><code>pbir-utils</code> can be integrated into your CI/CD pipeline to validate Power BI reports before deployment. This ensures all reports adhere to your team's standards and best practices.</p> <p>This guide demonstrates how to set up CI/CD checks for both GitHub Actions and Azure DevOps using a single, platform-agnostic validation script.</p>"},{"location":"ci_cd/#repository-structure","title":"Repository Structure","text":"<p>A typical repository structure for Power BI projects using <code>pbir-utils</code> might look like this:</p> <pre><code>my-powerbi-repo/\n\u251c\u2500\u2500 src/\n\u2502   \u251c\u2500\u2500 SalesReport.Report/      # PBIR Source Folder\n\u2502   \u2502   \u251c\u2500\u2500 definition/\n\u2502   \u2502   \u2514\u2500\u2500 ...\n\u2502   \u251c\u2500\u2500 HRReport.Report/\n\u2502   \u2514\u2500\u2500 ...\n\u251c\u2500\u2500 scripts/\n\u2502   \u2514\u2500\u2500 check_reports.py         # The validation script (works on any CI)\n\u251c\u2500\u2500 pbir-sanitize.yaml           # (Optional) Customize sanitizer actions/severity\n\u251c\u2500\u2500 pbir-rules.yaml              # (Optional) Customize expression rules\n</code></pre> <p>Optional Configuration</p> <p>Both config files are optional. Without them, <code>validate_report()</code> uses the default sanitize actions and default expression rules. Config files are auto-discovered when placed in the repository root or report folder.</p>"},{"location":"ci_cd/#1-define-sanitization-standards-optional","title":"1. Define Sanitization Standards (Optional)","text":"<p>Customize which actions run or their severity levels:</p> <pre><code># pbir-sanitize.yaml\n# By default, runs standard actions (remove_unused_measures, etc.)\n\ndefinitions:\n  # Override severity for specific actions\n  remove_unused_measures:\n    severity: error  # Make this a hard failure in CI\n\n  cleanup_invalid_bookmarks:\n    severity: warning  # Standard warning\n\n  # Define custom actions\n  remove_identifier_filters:\n    implementation: clear_filters\n    params:\n      include_columns: [\"*Id*\", \"* ID*\"]\n      clear_all: true\n    description: \"Remove filters on identifier columns\"\n    severity: warning\n\n# Exclude specific default actions if needed\nexclude:\n  - set_first_page_as_active\n  - remove_empty_pages\n\n# Include additional actions\ninclude:\n  - standardize_pbir_folders \n  - remove_identifier_filters\n</code></pre>"},{"location":"ci_cd/#2-define-expression-rules-optional","title":"2. Define Expression Rules (Optional)","text":"<p>Add custom expression rules or customize severity:</p> <pre><code># pbir-rules.yaml\n\noptions:\n  # Fail build if ANY warning occurs? (Default strict=True fails on errors only)\n  fail_on_warning: false\n\ndefinitions:\n  # Override default rule severity\n  reduce_visuals_on_page:\n    severity: warning\n    params:\n      max_visuals: 15  # Stricter than default 20\n\n  # Add custom expression-based rules\n  ensure_visual_title:\n    description: \"All visuals must have a title\"\n    severity: warning\n    scope: visual\n    expression: |\n      len(visual.get(\"visual\", {}).get(\"visualContainer\", {}).get(\"title\", {}).get(\"text\", \"\")) &gt; 0\n\n  require_page_description:\n    description: \"All pages should have descriptions\"\n    severity: info\n    scope: page\n    expression: |\n      len(page.get(\"displayOption\", {}).get(\"description\", \"\")) &gt; 0\n\ninclude:\n  - ensure_visual_title\n  - require_page_description\n</code></pre>"},{"location":"ci_cd/#3-create-the-validation-script","title":"3. Create the Validation Script","text":"<p>Create a Python script (e.g., <code>scripts/check_reports.py</code>) that validates each report:</p> <pre><code>\"\"\"CI/CD validation script for Power BI reports.\"\"\"\nimport sys\nfrom pathlib import Path\nfrom pbir_utils import validate_report\n\nREPORT_PATTERN = \"**/*.Report\"\n\ndef main() -&gt; None:\n    reports = list(Path.cwd().glob(REPORT_PATTERN))\n    if not reports:\n        print(f\"No reports found matching '{REPORT_PATTERN}'\")\n        return\n\n    results = []\n    for report_path in reports:\n        # Run all checks (sanitizer + expression rules)\n        result = validate_report(str(report_path), strict=False)\n        results.append((report_path.name, result))\n\n    # Print summary and check for errors\n    print(\"\\n=== SUMMARY ===\")\n    has_errors = False\n    for name, r in results:\n        print(f\"'{name}': {r}\")\n        has_errors = has_errors or r.has_errors\n\n    sys.exit(1 if has_errors else 0)\n\nif __name__ == \"__main__\":\n    main()\n</code></pre> <p>The script is simple because <code>validate_report()</code> already:</p> <ul> <li>Runs both sanitizer checks (from <code>pbir-sanitize.yaml</code>) and expression rules (from <code>pbir-rules.yaml</code>)</li> <li>Prints detailed results with <code>[Sanitizer Checks]</code> and <code>[Expression Rules]</code> sections</li> <li>Shows a summary line: \"Validation complete: 5 passed, 9 warning(s), 3 info\"</li> <li>Returns a <code>ValidationResult</code> with <code>.has_errors</code>, <code>.error_count</code>, <code>.warning_count</code>, etc.</li> </ul>"},{"location":"ci_cd/#advanced-cherry-pick-specific-checks","title":"Advanced: Cherry-Pick Specific Checks","text":"<p>You can also run specific checks:</p> <pre><code># Run only sanitizer checks (e.g., for faster CI on draft PRs)\nresult = validate_report(str(report_path), source=\"sanitize\", strict=False)\n\n# Run specific actions only\nresult = validate_report(\n    str(report_path), \n    actions=[\"remove_unused_measures\", \"cleanup_invalid_bookmarks\"],\n    strict=False\n)\n\n# Run only expression rules\nresult = validate_report(str(report_path), source=\"rules\", strict=False)\n</code></pre>"},{"location":"ci_cd/#4-configure-your-ci-pipeline","title":"4. Configure Your CI Pipeline","text":""},{"location":"ci_cd/#github-actions","title":"GitHub Actions","text":"<p>Create <code>.github/workflows/validate-reports.yml</code>:</p> <pre><code>name: Validate Power BI Reports\n\non:\n  pull_request:\n    branches: [main]\n  push:\n    branches: [main]\n\njobs:\n  validate:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v4\n\n      - name: Install uv\n        uses: astral-sh/setup-uv@v7\n\n      - name: Validate Reports\n        run: uv run --with pbir-utils python scripts/check_reports.py\n</code></pre>"},{"location":"ci_cd/#azure-devops","title":"Azure DevOps","text":"<p>Create <code>azure-pipelines.yaml</code>:</p> <pre><code>trigger:\n  - main\n\npr:\n  - main\n\npool:\n  vmImage: 'ubuntu-latest'\n\nsteps:\n  - checkout: self\n    fetchDepth: 1\n\n  - task: UsePythonVersion@0\n    inputs:\n      versionSpec: '3.12'\n      addToPath: true\n\n  - script: pip install uv\n    displayName: 'Install uv'\n\n  - script: uv run --with pbir-utils python scripts/check_reports.py\n    displayName: 'Validate Power BI Reports'\n</code></pre>"},{"location":"ci_cd/#how-it-works","title":"How it Works","text":"<ol> <li>Pull Request: When a developer opens a PR, the pipeline runs.</li> <li>Validation: The script scans all reports and runs <code>validate_report</code>.</li> <li>Configuration Loading: </li> <li>Loads <code>pbir-sanitize.yaml</code> for sanitizer checks (with action severities).</li> <li>Loads <code>pbir-rules.yaml</code> for expression rules.</li> <li>Runs both by default (use <code>source</code> to filter).</li> <li>Result: Build fails only if any <code>error</code> level violations are found.</li> </ol>"},{"location":"ci_cd/#auto-fixing-local-only","title":"Auto-fixing (Local Only)","text":"<p>Do not run sanitize in CI/CD</p> <p>Running sanitization as an automated fix in CI/CD is not recommended because:</p> <ul> <li>It modifies code without explicit developer review</li> <li>It can cause commit loops or merge conflicts</li> <li>Some actions (like removing measures) may need human judgment if defaults are too aggressive</li> </ul> <p>Recommended approach: Run sanitization locally to fix issues flagged by CI:</p> <pre><code># Developer runs locally to fix sanitizer issues\npbir-utils sanitize \"src/SalesReport.Report\"\ngit add .\ngit commit -m \"Fix validation errors\"\n</code></pre> <p>Because validation uses the SAME <code>pbir-sanitize.yaml</code> for checks, running <code>sanitize</code> locally is guaranteed to fix all sanitizer-related issues. Expression rules (like <code>ensure_visual_title</code>) require manual fixing in Power BI Desktop.</p> <p>Preview before applying</p> <p>Use <code>--dry-run</code> first to preview what changes will be made: <pre><code>pbir-utils sanitize \"src/SalesReport.Report\" --dry-run\n</code></pre></p>"},{"location":"cli/","title":"CLI Reference","text":"<p>The <code>pbir-utils</code> command-line interface provides access to all utilities after installation.</p> <p>Summary Mode</p> <p>Use the <code>--summary</code> flag with any command to get concise count-based output instead of detailed messages.</p>"},{"location":"cli/#ui-web-interface","title":"UI (Web Interface)","text":"<p>The <code>pbir-utils</code> web interface provides a rich, interactive way to browse reports, visualize wireframes, and execute actions.</p> <p>For detailed documentation on the UI features, please see the UI Guide.</p> <pre><code># Launch UI (opens browser automatically)\npbir-utils ui\n</code></pre>"},{"location":"cli/#sanitize-report","title":"Sanitize Report","text":"<p>Sanitize a Power BI report by applying best practices, standardizing configurations, and removing unused components. Runs default actions from config when no <code>--actions</code> specified.</p> <pre><code># Run default actions from config (--actions all is optional)\npbir-utils sanitize \"C:\\Reports\\MyReport.Report\" --dry-run\n\n# Run specific actions only\npbir-utils sanitize \"C:\\Reports\\MyReport.Report\" --actions remove_unused_measures --dry-run\n\n# Exclude specific actions from defaults\npbir-utils sanitize \"C:\\Reports\\MyReport.Report\" --exclude set_first_page_as_active --dry-run\n\n# Include additional actions beyond defaults\npbir-utils sanitize \"C:\\Reports\\MyReport.Report\" --include standardize_pbir_folders set_page_size --dry-run\n\n# Concise output\npbir-utils sanitize \"C:\\Reports\\MyReport.Report\" --summary\n</code></pre>"},{"location":"cli/#available-actions","title":"Available Actions","text":"<p>The following actions are available for use with <code>--actions</code>, <code>--include</code>, or <code>--exclude</code>:</p> <p>Default Actions</p> <p>Actions marked with \u2713 run by default when no flags are specified. Use <code>--include</code> to add additional actions, or <code>--exclude</code> to skip default ones.</p> Action Description Default <code>cleanup_invalid_bookmarks</code> Remove bookmarks referencing non-existent pages or visuals \u2713 <code>remove_unused_bookmarks</code> Remove bookmarks not used by bookmark navigators or visual link actions \u2713 <code>remove_unused_measures</code> Remove measures not used in visuals (preserves measures referenced by used measures) \u2713 <code>remove_unused_custom_visuals</code> Remove custom visual registrations not used by any visual \u2713 <code>disable_show_items_with_no_data</code> Turn off \"Show items with no data\" on visuals (improves performance by hiding rows/columns with blank values) \u2713 <code>remove_hidden_visuals_never_shown</code> Remove permanently hidden visuals not revealed by bookmarks (keeps hidden slicer visuals that have default values or are controlled by bookmarks) \u2713 <code>remove_empty_pages</code> Remove pages without visuals and clean up orphan folders \u2713 <code>set_first_page_as_active</code> Set the first non-hidden page as the default active page \u2713 <code>reset_filter_pane_width</code> Remove custom filter pane width from all pages \u2713 <code>hide_tooltip_pages</code> Set visibility to hidden for Tooltip pages \u2713 <code>hide_drillthrough_pages</code> Set visibility to hidden for Drillthrough pages <code>standardize_pbir_folders</code> Rename folders to be descriptive (e.g., <code>Overview_abc123</code> for pages, <code>slicer_xyz789</code> for visuals) <code>set_page_size_16_9</code> Set all non-tooltip pages to 1280\u00d7720 <code>expand_filter_pane</code> Show and expand the filter pane <code>collapse_filter_pane</code> Show but collapse the filter pane <code>hide_filter_pane</code> Hide the filter pane entirely <code>sort_filters_selected_top</code> Sort filters with applied conditions first, then alphabetically <code>sort_filters_ascending</code> Sort all filters alphabetically (A-Z) <code>clear_all_report_filters</code> Clear all report-level filter conditions <code>set_display_option_fit_to_page</code> Set all pages to FitToPage display mode <code>set_display_option_fit_to_width</code> Set all pages to FitToWidth display mode <code>set_display_option_actual_size</code> Set all pages to ActualSize display mode"},{"location":"cli/#yaml-configuration","title":"YAML Configuration","text":"<p>Create a <code>pbir-sanitize.yaml</code> file to customize defaults. You only need to specify what you want to change - defaults are inherited.</p> <pre><code># pbir-sanitize.yaml - extends package defaults\n\n# Define or override action implementations and parameters\ndefinitions:\n  # --- Custom Action Examples ---\n  set_page_size_hd:         # Custom action name\n    description: Set page size to HD (1920x1080)\n    implementation: set_page_size\n    params:\n      width: 1920\n      height: 1080\n      exclude_tooltip: true\n\n  clear_all_report_filters:\n    description: Clear all report-level filter conditions\n    implementation: clear_filters\n    params:\n      clear_all: true\n      dry_run: false\n\n  clear_date_filters:\n    description: Clear filters on Date tables\n    implementation: clear_filters\n    params:\n      include_tables:\n        - \"Date*\"\n      clear_all: true\n\n  set_display_option_fit_to_page:\n    description: Set all pages to FitToPage display\n    implementation: set_page_display_option\n    params:\n      display_option: FitToPage\n\n# Override default action list (replaces, does not merge)\n# actions:\n#   - cleanup_invalid_bookmarks\n#   - remove_unused_measures\n#   - set_page_size_hd          # Use our custom definition\n#   - clear_all_report_filters  # usage of common action configuration\n\n# Or use include/exclude to modify defaults\ninclude:\n  - standardize_pbir_folders    # part of additional actions\n  - set_display_option_fit_to_page # Custom action\n  - clear_date_filters        # Custom action\n  - set_page_size_hd          # Custom action\n  - clear_all_report_filters  # Custom action\n\nexclude:\n  - set_first_page_as_active\n\noptions:\n  summary: true               # Override default options\n</code></pre> <p>Custom Action Implementations</p> <p>The <code>implementation</code> field can reference any function from the Python API. This allows you to wrap any API function with custom parameters as a reusable sanitize action.</p>"},{"location":"cli/#config-resolution-priority","title":"Config Resolution Priority","text":"<p>Configuration is resolved in the following order (highest to lowest):</p> <ol> <li>CLI flags (<code>--dry-run</code>, <code>--exclude</code>, etc.)</li> <li>User config (<code>pbir-sanitize.yaml</code> in CWD or report folder)</li> <li>Package defaults (<code>defaults/sanitize.yaml</code>)</li> </ol> <p>Auto-Discovery</p> <ul> <li>Config: Place <code>pbir-sanitize.yaml</code> in your report folder or current directory and it will be used automatically. Use <code>--config path/to/config.yaml</code> to specify a different file.</li> <li>Report Path: When running from inside a <code>.Report</code> folder, the report path argument is optional\u2014it will be detected automatically.</li> </ul> <p>See Also: YAML Configuration Basics for common patterns like <code>definitions</code>, <code>include</code>/<code>exclude</code>, merge behavior, and config discovery.</p>"},{"location":"cli/#validate-report","title":"Validate Report","text":"<p>Validate a Power BI report against configurable checks. By default, runs both:</p> <ul> <li>Sanitizer checks: Verify that sanitize actions wouldn't make changes (from <code>pbir-sanitize.yaml</code>)</li> <li>Expression rules: Evaluate conditions on report structure (from <code>pbir-rules.yaml</code>)</li> </ul> <pre><code># Validate with all checks (default)\npbir-utils validate \"C:\\Reports\\MyReport.Report\"\n\n# Run only sanitizer checks\npbir-utils validate \"C:\\Reports\\MyReport.Report\" --source sanitize\n\n# Run only expression rules\npbir-utils validate \"C:\\Reports\\MyReport.Report\" --source rules\n\n# Run specific sanitizer actions only\npbir-utils validate \"C:\\Reports\\MyReport.Report\" --actions remove_unused_measures cleanup_invalid_bookmarks\n\n# Run specific expression rules only\npbir-utils validate \"C:\\Reports\\MyReport.Report\" --rules reduce_pages reduce_visuals_on_page\n\n# Filter by minimum severity\npbir-utils validate \"C:\\Reports\\MyReport.Report\" --severity warning\n\n# Strict mode for CI/CD (exit code 1 on violations)\npbir-utils validate \"C:\\Reports\\MyReport.Report\" --strict\n\n# JSON output for scripting\npbir-utils validate \"C:\\Reports\\MyReport.Report\" --format json\n\n# Use custom config files\npbir-utils validate \"C:\\Reports\\MyReport.Report\" --sanitize-config custom-sanitize.yaml\npbir-utils validate \"C:\\Reports\\MyReport.Report\" --rules-config custom-rules.yaml\n</code></pre>"},{"location":"cli/#sample-output","title":"Sample Output","text":"<pre><code>Validating MyReport.Report\n--------------------------\n\n[Sanitizer Checks]\n[WARNING] Remove unused measures\n    \u2514\u2500 Would remove measures: Dummy, Dummy1\n[PASS] Clean up invalid bookmarks\n[WARNING] Remove unused bookmarks\n    \u2514\u2500 Would remove bookmarks: Unused Bookmark\n[INFO] Set the first non-hidden page as active\n    \u2514\u2500 Would set 'Home' as the active page.\n\n[Expression Rules]\n[PASS] Reports with too many pages are harder to navigate\n[INFO] Visuals with more data fields degrade performance\n    \u2514\u2500 Page: Driver Info, Visual: 25956ecd7135217b00b2\n\n\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\nValidation complete: 3 passed, 2 warning(s), 2 info\n\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\n</code></pre>"},{"location":"cli/#exit-codes","title":"Exit Codes","text":"Code Meaning <code>0</code> All checks passed (or no <code>--strict</code> flag) <code>1</code> Violations found (with <code>--strict</code>) or errors when <code>fail_on_warning: true</code>"},{"location":"cli/#cli-options","title":"CLI Options","text":"Option Description <code>--source</code> Which checks to run: <code>all</code> (default), <code>sanitize</code>, or <code>rules</code> <code>--actions</code> Specific sanitizer action IDs to check (from <code>pbir-sanitize.yaml</code>) <code>--rules</code> Specific expression rule IDs to run (from <code>pbir-rules.yaml</code>) <code>--sanitize-config</code> Path to a custom sanitize config YAML file (default: auto-discovered) <code>--rules-config</code> Path to a custom rules config YAML file (default: auto-discovered) <code>--severity</code> Minimum severity to report (<code>info</code>, <code>warning</code>, <code>error</code>) <code>--strict</code> Exit with code 1 if any violations found <code>--format</code> Output format: <code>console</code> (default) or <code>json</code>"},{"location":"cli/#sanitizer-checks","title":"Sanitizer Checks","text":"<p>Sanitizer checks verify that sanitize actions from <code>pbir-sanitize.yaml</code> wouldn't make changes. Each action has its own severity level defined in the sanitize config.</p> <p>Default Severity Levels:</p> Actions Default Severity <code>cleanup_invalid_bookmarks</code>, <code>remove_unused_bookmarks</code>, <code>remove_unused_measures</code>, <code>remove_unused_custom_visuals</code>, <code>remove_hidden_visuals_never_shown</code>, <code>remove_empty_pages</code> <code>warning</code> <code>set_first_page_as_active</code>, <code>disable_show_items_with_no_data</code>, <code>reset_filter_pane_width</code>, <code>hide_tooltip_pages</code>, cosmetic actions <code>info</code> <p>You can customize severity in <code>pbir-sanitize.yaml</code>:</p> <pre><code># pbir-sanitize.yaml\ndefinitions:\n  remove_unused_measures:\n    severity: error  # Make this a hard error for CI/CD\n\n  cleanup_invalid_bookmarks:\n    severity: info   # Downgrade to info\n</code></pre>"},{"location":"cli/#expression-rules","title":"Expression Rules","text":"<p>Expression rules from <code>pbir-rules.yaml</code> evaluate conditions on report structure. Built-in rules:</p> Rule Severity Description <code>reduce_pages</code> info Reports with more than 10 pages <code>reduce_visuals_on_page</code> info Pages with more than 20 visuals <code>reduce_objects_within_visuals</code> info Visuals with more than 6 data fields <code>reduce_topn_filters</code> info Visuals with multiple TopN filters <code>reduce_advanced_filters</code> info Visuals with multiple Advanced filters <code>ensure_theme_colors</code> info Avoid hardcoded hex colors; use ThemeDataColor (disabled by default)"},{"location":"cli/#yaml-configuration_1","title":"YAML Configuration","text":"<p>Create separate YAML files to customize each type of check:</p> <p><code>pbir-sanitize.yaml</code> - Customize sanitizer actions and severities:</p> <pre><code>definitions:\n  remove_unused_measures:\n    severity: error\n\n  # Custom action with custom severity\n  my_filter_check:\n    description: \"Custom filter check\"\n    severity: warning\n    implementation: clear_filters\n    params:\n      dry_run: true\n\n# Include additional actions in validation\ninclude:\n  - standardize_pbir_folders\n\n# Exclude actions from validation\nexclude:\n  - set_first_page_as_active\n</code></pre> <p><code>pbir-rules.yaml</code> - Customize expression rules:</p> <pre><code>options:\n  fail_on_warning: false\n\ndefinitions:\n  # Override built-in rule severity\n  reduce_visuals_on_page:\n    severity: warning\n    params:\n      max_visuals: 15  # Stricter than default 20\n\n  # Disable a noisy rule\n  reduce_advanced_filters:\n    disabled: true\n\n  # Custom expression rule\n  require_page_names:\n    description: \"All pages must have descriptive names\"\n    severity: warning\n    scope: page\n    expression: |\n      not page.get(\"displayName\", \"\").startswith(\"Page \")\n\ninclude:\n  - require_page_names\n\nexclude:\n  - reduce_topn_filters\n</code></pre> <p>See Also: YAML Configuration Basics for common patterns like merge behavior, <code>disabled</code> flag, and config discovery.</p>"},{"location":"cli/#expression-rules-reference","title":"Expression Rules Reference","text":""},{"location":"cli/#available-scopes","title":"Available Scopes","text":"Scope Context Variable Description <code>report</code> <code>report</code> Full report context (pages, bookmarks, reportExtensions, etc.) <code>page</code> <code>page</code> Current page object (with <code>visuals</code> array) <code>visual</code> <code>visual</code>, <code>page</code> Current visual object and its parent page <code>measure</code> <code>measure</code>, <code>entity</code> Current measure object and its parent entity <code>bookmark</code> <code>bookmark</code> Current bookmark object"},{"location":"cli/#available-functions","title":"Available Functions","text":"<p>Built-in: <code>len()</code>, <code>sum()</code>, <code>min()</code>, <code>max()</code>, <code>any()</code>, <code>all()</code>, <code>sorted()</code>, <code>reversed()</code></p> <p>Regex: <code>re_match(pattern, string)</code>, <code>re_search(pattern, string)</code></p> <p>JSON Traversal Helpers:</p> Function Description Example <code>get_path(obj, path, default)</code> Safely navigate nested properties using dot notation <code>get_path(visual, \"visual.query.projections\")</code> <code>has_path(obj, path)</code> Check if a nested path exists <code>has_path(visual, \"visual.objects.fill\")</code> <code>find_all(obj, key)</code> Recursively find all values for a key (like JSONPath <code>$..key</code>) <code>find_all(visual, \"projections\")</code> <p>Helper Examples:</p> <pre><code>definitions:\n  # Use get_path to simplify deep property access\n  check_visual_type:\n    scope: visual\n    expression: &gt;\n      get_path(visual, \"visual.visualType\") == \"slicer\"\n\n  # Use find_all to search recursively (like JSONPath $..projections)\n  count_all_projections:\n    scope: visual\n    params:\n      max_fields: 6\n    expression: &gt;\n      sum(len(p) for p in find_all(get_path(visual, \"visual.query\"), \"projections\")) &lt;= max_fields\n\n  # Use has_path for existence checks\n  require_alt_text:\n    scope: visual\n    expression: &gt;\n      has_path(visual, \"visual.visualContainerObjects.general\")\n\n  # Combine helpers with regex for powerful validation\n  ensure_theme_colors:\n    scope: visual\n    expression: &gt;\n      get_path(visual, \"visual.visualType\") == \"textbox\" or \n      all(not re_search(r'#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})', str(c)) \n          for c in find_all(visual, \"color\"))\n</code></pre>"},{"location":"cli/#writing-expression-rules","title":"Writing Expression Rules","text":"<p>Step 1: Explore the PBIR Structure</p> <p>Open your report's JSON files to see the exact structure and property names available:</p> <pre><code>MyReport.Report/\n\u251c\u2500\u2500 definition/\n\u2502   \u251c\u2500\u2500 report.json              # Report settings\n\u2502   \u251c\u2500\u2500 reportExtensions.json    # Measures\n\u2502   \u251c\u2500\u2500 pages/\n\u2502   \u2502   \u2514\u2500\u2500 {pageId}/\n\u2502   \u2502       \u251c\u2500\u2500 page.json        # Page properties\n\u2502   \u2502       \u2514\u2500\u2500 visuals/\n\u2502   \u2502           \u2514\u2500\u2500 {visualId}/\n\u2502   \u2502               \u2514\u2500\u2500 visual.json  # Visual config\n</code></pre> <p>Step 2: Write the Expression</p> <p>Expressions are Python code that returns <code>True</code> (pass) or <code>False</code> (violation):</p> <pre><code>definitions:\n  require_page_description:\n    description: \"All pages should have descriptions\"\n    severity: warning\n    scope: page\n    expression: |\n      len(page.get(\"displayOption\", {}).get(\"description\", \"\")) &gt; 0\n</code></pre> <p>Step 3: Use Parameters for Flexibility</p> <pre><code>definitions:\n  max_visuals_per_page:\n    description: \"Limit visuals per page\"\n    severity: warning\n    scope: page\n    params:\n      max_visuals: 15\n      excluded_types: [\"shape\", \"textbox\"]\n    expression: |\n      len([v for v in page.get(\"visuals\", [])\n           if get_path(v, \"visual.visualType\") not in excluded_types]) &lt;= max_visuals\n</code></pre>"},{"location":"cli/#complete-example","title":"Complete Example","text":"<pre><code># pbir-rules.yaml\noptions:\n  fail_on_warning: false\n\ndefinitions:\n  # Override severity\n  reduce_visuals_on_page:\n    severity: warning\n    params:\n      max_visuals: 10  # Stricter\n\n  # Disable noisy rule\n  reduce_advanced_filters:\n    disabled: true\n\n  # Custom rule\n  require_page_names:\n    description: \"All pages must have descriptive names (not 'Page 1')\"\n    severity: warning\n    scope: page\n    expression: |\n      not page.get(\"displayName\", \"\").startswith(\"Page \")\n\ninclude:\n  - require_page_names\n\nexclude:\n  - reduce_topn_filters\n</code></pre>"},{"location":"cli/#visualize-wireframes","title":"Visualize Wireframes","text":"<p>Generate a static HTML wireframe of the report layout. This creates a lightweight, portable HTML file that visualizes the position and size of visuals across pages.</p> <p>For full documentation on the visualization features, see the UI Guide.</p> <pre><code># Generate wireframe for all pages\npbir-utils visualize \"C:\\Reports\\MyReport.Report\"\n</code></pre>"},{"location":"cli/#extract-metadata","title":"Extract Metadata","text":"<p>Extract metadata from PBIR reports to CSV. Supports two modes: attribute metadata (default) and visual metadata (<code>--visuals-only</code>).</p> <p>You can specify a single <code>.Report</code> folder or a parent directory containing multiple reports. When a parent directory is provided, the tool recursively processes all reports found within it.</p> <p>If no output path is specified, creates <code>metadata.csv</code> (or <code>visuals.csv</code> with <code>--visuals-only</code>) in the report folder.</p>"},{"location":"cli/#attribute-metadata-default","title":"Attribute Metadata (Default)","text":"<p>Exports detailed information about tables, columns, measures, DAX expressions, and usage contexts.</p> <pre><code># Creates metadata.csv in the report folder\npbir-utils extract-metadata \"C:\\Reports\\MyReport.Report\"\n\n# With custom output path\npbir-utils extract-metadata \"C:\\Reports\\MyReport.Report\" \"C:\\Output\\metadata.csv\"\n\n# Filter by page name(s)\npbir-utils extract-metadata \"C:\\Reports\\MyReport.Report\" --pages \"Overview\" \"Detail\"\n\n# Filter by report name(s) when processing a directory\npbir-utils extract-metadata \"C:\\Reports\" --reports \"Report1\" \"Report2\"\n</code></pre> <p>Output columns: Report, Page Name, Page ID, Table, Column or Measure, Expression, Used In, Used In Detail, ID</p>"},{"location":"cli/#visual-metadata","title":"Visual Metadata","text":"<p>Exports visual-level information including type, grouping, and hidden status.</p> <pre><code># Creates visuals.csv in the report folder\npbir-utils extract-metadata \"C:\\Reports\\MyReport.Report\" --visuals-only\n\n# Filter by visual type\npbir-utils extract-metadata \"C:\\Reports\\MyReport.Report\" --visuals-only --visual-types slicer card\n\n# With custom output path\npbir-utils extract-metadata \"C:\\Reports\\MyReport.Report\" \"C:\\Output\\visuals.csv\" --visuals-only\n</code></pre> <p>Output columns: Report, Page Name, Page ID, Visual Type, Visual ID, Parent Group ID, Is Hidden</p>"},{"location":"cli/#cli-options_1","title":"CLI Options","text":"Option Description <code>--pages</code> Filter by page displayName(s) <code>--reports</code> Filter by report name(s) when processing a directory <code>--tables</code> Filter by table name(s) <code>--visual-types</code> Filter by visual type(s) (for <code>--visuals-only</code> mode) <code>--visual-ids</code> Filter by visual ID(s) (for <code>--visuals-only</code> mode) <code>--visuals-only</code> Extract visual-level metadata instead of attribute usage <code>--filters</code> [Deprecated] JSON string filter. Use explicit arguments instead."},{"location":"cli/#batch-update","title":"Batch Update","text":"<p>Batch update attributes in PBIR project using a mapping CSV.</p> <pre><code>pbir-utils batch-update \"C:\\PBIR\\Project\" \"C:\\Mapping.csv\" --dry-run\n</code></pre>"},{"location":"cli/#csv-format","title":"CSV Format","text":"<p>The mapping CSV should have these columns:</p> old_tbl old_col new_tbl new_col Sale sale_id Sales Sale Id Sale order_date Sales OrderDate Date Dates Product product_name Product Name <ul> <li>If a table name is unchanged, <code>new_tbl</code> is optional</li> <li>If only the table name changes, <code>old_col</code> and <code>new_col</code> can be omitted</li> </ul>"},{"location":"cli/#disable-interactions","title":"Disable Interactions","text":"<p>Disable visual interactions between visuals. Useful for preventing slicers or other visuals from affecting specific targets.</p> <pre><code># Disable all interactions on all pages\npbir-utils disable-interactions \"C:\\Reports\\MyReport.Report\" --dry-run\n\n# Disable slicer interactions on specific pages\npbir-utils disable-interactions \"C:\\Reports\\MyReport.Report\" --pages \"Overview\" --source-visual-types slicer\n\n# Disable interactions from specific source to target visuals\npbir-utils disable-interactions \"C:\\Reports\\MyReport.Report\" --source-visual-ids \"abc123\" --target-visual-types card\n\n# Use Insert mode to add without modifying existing\npbir-utils disable-interactions \"C:\\Reports\\MyReport.Report\" --update-type Insert --dry-run\n</code></pre>"},{"location":"cli/#cli-options_2","title":"CLI Options","text":"Option Description <code>--pages</code> List of page names to process (default: all pages) <code>--source-visual-ids</code> List of source visual IDs <code>--source-visual-types</code> List of source visual types (e.g., <code>slicer</code>) <code>--target-visual-ids</code> List of target visual IDs <code>--target-visual-types</code> List of target visual types <code>--update-type</code> Update strategy: <code>Upsert</code> (default), <code>Insert</code>, or <code>Overwrite</code> <code>--dry-run</code> Preview changes without modifying files <code>--summary</code> Show count-based summary instead of detailed messages"},{"location":"cli/#update-types","title":"Update Types","text":"Type Behavior <code>Upsert</code> Disables matching interactions and inserts new ones. Existing non-matching interactions remain unchanged. (Default) <code>Insert</code> Only inserts new interactions without modifying existing ones. <code>Overwrite</code> Replaces all existing interactions with the new configuration."},{"location":"cli/#behavior","title":"Behavior","text":"<p>The command's scope depends on which options are provided:</p> <ol> <li>Only report path: Disables interactions between all visuals across all pages.</li> <li>With <code>--pages</code>: Disables interactions between all visuals on the specified pages only.</li> <li>With <code>--source-visual-ids</code> or <code>--source-visual-types</code>: Disables interactions from the specified sources to all targets.</li> <li>With <code>--target-visual-ids</code> or <code>--target-visual-types</code>: Disables interactions to the specified targets from all sources.</li> </ol>"},{"location":"cli/#remove-measures","title":"Remove Measures","text":"<p>Remove report-level measures. By default, only removes measures that are not used in any visuals (including their dependents).</p> <pre><code># Remove all unused measures (checks visual usage)\npbir-utils remove-measures \"C:\\Reports\\MyReport.Report\" --dry-run\n\n# Remove specific measures by name\npbir-utils remove-measures \"C:\\Reports\\MyReport.Report\" --measure-names \"Measure1\" \"Measure2\"\n\n# Force remove without checking visual usage\npbir-utils remove-measures \"C:\\Reports\\MyReport.Report\" --measure-names \"OldMeasure\" --no-check-usage\n</code></pre>"},{"location":"cli/#cli-options_3","title":"CLI Options","text":"Option Description <code>--measure-names</code> List of specific measure names to remove (default: all measures) <code>--no-check-usage</code> Skip visual usage check before removing (default: checks usage) <code>--dry-run</code> Preview changes without modifying files <code>--summary</code> Show count-based summary instead of detailed messages"},{"location":"cli/#measure-dependencies","title":"Measure Dependencies","text":"<p>Generate a dependency tree for measures, showing which measures depend on other measures.</p> <pre><code># Show all measure dependencies\npbir-utils measure-dependencies \"C:\\Reports\\MyReport.Report\"\n\n# Analyze specific measures\npbir-utils measure-dependencies \"C:\\Reports\\MyReport.Report\" --measure-names \"Total Sales\" \"Profit Margin\"\n\n# Include visual IDs that use each measure\npbir-utils measure-dependencies \"C:\\Reports\\MyReport.Report\" --include-visual-ids\n</code></pre>"},{"location":"cli/#cli-options_4","title":"CLI Options","text":"Option Description <code>--measure-names</code> List of specific measure names to analyze (default: all measures) <code>--include-visual-ids</code> Include visual IDs where each measure is used in the output"},{"location":"cli/#update-filters","title":"Update Filters","text":"<p>Update report-level filters.</p> <pre><code>pbir-utils update-filters \"C:\\Reports\" '[{\"Table\": \"Sales\", \"Column\": \"Region\", \"Condition\": \"In\", \"Values\": [\"North\", \"South\"]}]' --dry-run\n</code></pre>"},{"location":"cli/#condition-types","title":"Condition Types","text":"Category Conditions Expected Values Comparison <code>GreaterThan</code>, <code>GreaterThanOrEqual</code>, <code>LessThan</code>, <code>LessThanOrEqual</code> Single value Range <code>Between</code>, <code>NotBetween</code> Two values (start, end) Inclusion <code>In</code>, <code>NotIn</code> List of one or more values Text Matching <code>Contains</code>, <code>StartsWith</code>, <code>EndsWith</code>, <code>NotContains</code>, <code>NotStartsWith</code>, <code>NotEndsWith</code> Single string Multi-Value Text <code>ContainsAnd</code>, <code>ContainsOr</code>, <code>StartsWithAnd</code>, <code>StartsWithOr</code>, <code>EndsWithAnd</code>, <code>EndsWithOr</code> List of two or more strings"},{"location":"cli/#filter-values","title":"Filter Values","text":"Value Type Format Example Date <code>DD-MMM-YYYY</code> string <code>\"15-Sep-2023\"</code> Numeric Integer or float <code>100</code>, <code>99.5</code> Text String <code>\"North\"</code> Clear Filter <code>null</code> or <code>None</code> Removes existing filter on the column"},{"location":"cli/#sort-filters","title":"Sort Filters","text":"<p>Sort report-level filter pane items. Default sort order is <code>SelectedFilterTop</code>.</p> <pre><code># Use default sort (SelectedFilterTop - filters with values first)\npbir-utils sort-filters \"C:\\Reports\\MyReport.Report\" --dry-run\n\n# Sort alphabetically\npbir-utils sort-filters \"C:\\Reports\\MyReport.Report\" --sort-order Ascending --dry-run\n\n# Custom order\npbir-utils sort-filters \"C:\\Reports\\MyReport.Report\" --sort-order Custom --custom-order \"Region\" \"Date\" \"Product\"\n</code></pre>"},{"location":"cli/#cli-options_5","title":"CLI Options","text":"Option Description <code>--sort-order</code> Sort strategy: <code>SelectedFilterTop</code> (default), <code>Ascending</code>, <code>Descending</code>, or <code>Custom</code> <code>--custom-order</code> List of filter names in desired order (required when using <code>Custom</code>) <code>--reports</code> List of specific reports to update (when processing a directory) <code>--dry-run</code> Preview changes without modifying files <code>--summary</code> Show count-based summary instead of detailed messages"},{"location":"cli/#sort-order-strategies","title":"Sort Order Strategies","text":"Strategy Description <code>SelectedFilterTop</code> Filters with applied conditions appear first (A-Z), followed by unselected filters (A-Z). (Default) <code>Ascending</code> Alphabetical order (A-Z) <code>Descending</code> Reverse alphabetical order (Z-A) <code>Custom</code> User-defined order via <code>--custom-order</code>"},{"location":"cli/#configure-filter-pane","title":"Configure Filter Pane","text":"<p>Configure filter pane visibility and expanded state.</p> <pre><code>pbir-utils configure-filter-pane \"C:\\Reports\\MyReport.Report\" --dry-run\npbir-utils configure-filter-pane \"C:\\Reports\\MyReport.Report\" --visible false --dry-run\npbir-utils configure-filter-pane \"C:\\Reports\\MyReport.Report\" --expanded true --dry-run\n</code></pre>"},{"location":"cli/#clear-filters","title":"Clear Filters","text":"<p>Inspect and clear filter conditions from Power BI reports at report, page, or visual level.</p> <pre><code># Inspect all report-level filters (dry-run by default)\npbir-utils clear-filters \"C:\\Reports\\MyReport.Report\" --dry-run\n\n# Clear all report-level filters (remove --dry-run to apply)\npbir-utils clear-filters \"C:\\Reports\\MyReport.Report\"\n\n# Inspect page-level filters (all pages)\npbir-utils clear-filters \"C:\\Reports\\MyReport.Report\" --page --dry-run\n\n# Target a specific page by name or ID\npbir-utils clear-filters \"C:\\Reports\\MyReport.Report\" --page \"Overview\" --dry-run\n\n# Inspect visual-level filters including slicers\npbir-utils clear-filters \"C:\\Reports\\MyReport.Report\" --visual --dry-run\n\n# Filter by table name (supports wildcards)\npbir-utils clear-filters \"C:\\Reports\\MyReport.Report\" --table \"Date*\" \"Sales\" --dry-run\n\n# Filter by column name (supports wildcards)\npbir-utils clear-filters \"C:\\Reports\\MyReport.Report\" --column \"Year\" \"*Date\" --dry-run\n\n# Filter by full field reference\npbir-utils clear-filters \"C:\\Reports\\MyReport.Report\" --field \"'Sales'[Amount]\" --dry-run\n\n# Get concise summary output\npbir-utils clear-filters \"C:\\Reports\\MyReport.Report\" --page --visual --dry-run --summary\n</code></pre>"},{"location":"cli/#cli-options_6","title":"CLI Options","text":"Option Description <code>--page [NAME]</code> Target pages. If no value, includes all pages. If value given, targets specific page by displayName or ID. <code>--visual [NAME]</code> Target visuals. If no value, includes all visuals. If value given, targets specific visual by name or type. <code>--table</code> Filter by table name(s), supports wildcards (e.g., <code>Date*</code>) <code>--column</code> Filter by column name(s), supports wildcards (e.g., <code>*Amount</code>) <code>--field</code> Filter by full field reference(s), supports wildcards (e.g., <code>'Sales'[*]</code>) <code>--dry-run</code> Preview which filters would be cleared without modifying files <code>--summary</code> Show concise count-based summary instead of detailed filter list"},{"location":"cli/#summary-output","title":"Summary Output","text":"<p>When using <code>--summary</code>, the output shows counts instead of individual filters:</p> <pre><code>[DRY RUN] Would clear: 2 report filter(s), 1 page filter(s) across 1 page(s), 2 slicer filter(s) across 2 slicer(s), 10 visual filter(s) across 9 visual(s)\n</code></pre>"},{"location":"cli/#slicer-support","title":"Slicer Support","text":"<p>The command automatically detects all slicer types including: - Standard slicers (<code>slicer</code>) - Chiclet slicers (<code>chicletSlicer</code>) - Timeline slicers (<code>timelineSlicer</code>) - Any custom slicer visuals containing \"slicer\" in the type name</p>"},{"location":"cli/#set-display-option","title":"Set Display Option","text":"<p>Set the display option for pages in a Power BI report. Controls how pages are rendered in the viewer.</p> <pre><code># Set all pages to FitToWidth (dry run)\npbir-utils set-display-option \"C:\\Reports\\MyReport.Report\" --option FitToWidth --dry-run\n\n# Set a specific page by display name\npbir-utils set-display-option \"C:\\Reports\\MyReport.Report\" --page \"Trends\" --option ActualSize\n\n# Set a specific page by internal name/ID\npbir-utils set-display-option \"C:\\Reports\\MyReport.Report\" --page \"bb40336091625ae0070a\" --option FitToPage\n\n# Apply to all pages with summary output\npbir-utils set-display-option \"C:\\Reports\\MyReport.Report\" --option FitToPage --summary\n</code></pre>"},{"location":"cli/#display-options","title":"Display Options","text":"Option Description <code>ActualSize</code> Pages display at their actual pixel dimensions <code>FitToPage</code> Pages scale to fit the entire page in the viewport <code>FitToWidth</code> Pages scale to fit the width of the viewport"},{"location":"cli/#cli-options_7","title":"CLI Options","text":"Option Description <code>--page NAME</code> Target specific page by displayName or internal name. If omitted, applies to all pages. <code>--option</code> Required. Display option to set (<code>ActualSize</code>, <code>FitToPage</code>, <code>FitToWidth</code>). <code>--dry-run</code> Preview changes without modifying files. <code>--summary</code> Show count-based summary instead of detailed messages."},{"location":"cli/#yaml-configuration-basics","title":"YAML Configuration Basics","text":"<p>Both <code>pbir-sanitize.yaml</code> and <code>pbir-rules.yaml</code> share a common structure. This section covers shared features.</p>"},{"location":"cli/#common-structure","title":"Common Structure","text":"<pre><code>definitions:\n  my_item:\n    description: \"Human-readable description\"\n    params:\n      key: value\n    disabled: true  # Skip this item by default\n\nactions:  # or 'rules:' for validation\n  - item1\n  - item2\n\ninclude:\n  - additional_item  # Add to default list\n\nexclude:\n  - unwanted_item    # Remove from list\n\noptions:\n  dry_run: false\n</code></pre>"},{"location":"cli/#merge-behavior","title":"Merge Behavior","text":"Section Behavior <code>definitions</code> Deep merge: User params merge with default params <code>actions</code>/<code>rules</code> Replace: Completely replaces default list <code>include</code> Append: Added to list <code>exclude</code> Remove: Removed from final list <code>options</code> Override: User options override defaults"},{"location":"cli/#params-deep-merge","title":"Params Deep Merge","text":"<p>Params are merged, not replaced:</p> <pre><code># Default: my_action has params {a: 1, b: 2}\ndefinitions:\n  my_action:\n    params:\n      a: 10  # Override 'a' only\n# Result: params = {a: 10, b: 2}\n</code></pre>"},{"location":"cli/#disabled-items","title":"Disabled Items","text":"<pre><code>definitions:\n  noisy_action:\n    disabled: true   # Won't run by default\n\ninclude:\n  - noisy_action     # Overrides disabled: true\n</code></pre>"},{"location":"cli/#config-discovery","title":"Config Discovery","text":"<ol> <li>Current working directory (checked first)</li> <li>Report folder (if <code>report_path</code> provided)</li> </ol> <p>Use <code>--config path/to/file.yaml</code> to specify explicitly.</p>"},{"location":"cli/#environment-variables","title":"Environment Variables","text":"Variable Description <code>PBIR_UTILS_NO_UPDATE_CHECK</code> Set to <code>1</code>, <code>true</code>, or <code>yes</code> to disable the automatic version update check on CLI startup."},{"location":"releases/","title":"Release Notes","text":""},{"location":"releases/#213-february-21-2026","title":"2.1.3 - February 21, 2026","text":""},{"location":"releases/#fixed","title":"Fixed","text":"<ul> <li>ui:</li> <li>Layout: Fixed a Firefox-only bug where the sidebar toggle button could appear detached from the sidebar edge (#3 by @Boreo).</li> </ul>"},{"location":"releases/#212-february-20-2026","title":"2.1.2 - February 20, 2026","text":""},{"location":"releases/#fixed_1","title":"Fixed","text":"<ul> <li>ui:</li> <li>Visuals: Fixed a bug where hiding a report-hidden visual would prevent interacting with or hiding the visuals underneath it.</li> <li>Layout: Fixed an issue where the report page would incorrectly shrink or overlap when expanding sidebars.</li> <li>Refresh Behavior: Ensured the latest app updates are immediately visible when refreshing the page, without needing to clear your browser cache.</li> </ul>"},{"location":"releases/#211-february-15-2026","title":"2.1.1 - February 15, 2026","text":""},{"location":"releases/#features","title":"Features","text":"<ul> <li>ui: <ul> <li>Updated Fields Pane selection behavior: defaults to single-select, supports <code>Ctrl+click</code> for multi-select.</li> <li>Moved Fields Pane selection controls to the header with a modern chip design for better visibility.</li> </ul> </li> </ul>"},{"location":"releases/#210-february-15-2026","title":"2.1.0 - February 15, 2026","text":""},{"location":"releases/#features_1","title":"Features","text":"<ul> <li>ui: <ul> <li>Improved initial view by collapsing secondary panes (Actions, Validate, Export, Output) by default.</li> <li>File browser now defaults to the current working directory instead of user home.</li> <li>Opening a report via CLI now correctly selects and highlights the report folder in the file browser.</li> <li>Fixed context menu not closing when clicking outside or selecting a visual.</li> <li>Fixed \"Hide Page\" icon in context menu.</li> <li>Fixed hidden pages not restoring when clicking the \"+X pages\" indicator.</li> <li>Enabled context menu and selection for \"Report Hidden\" visuals (dashed border).</li> <li>Improved visual distinction for selected hidden visuals (now uses blue dashed border).</li> <li>Added ability to drag-select multiple visuals on the report canvas.</li> <li>Added <code>Ctrl+click</code> support for adding/removing visuals from selection.</li> <li>Added bulk \"Hide Visuals\" option in context menu when multiple visuals are selected.</li> <li>Added ability to search and filter by page name or page ID in the report wireframe.</li> </ul> </li> </ul>"},{"location":"releases/#206-february-14-2026","title":"2.0.6 - February 14, 2026","text":""},{"location":"releases/#bug-fixes","title":"Bug Fixes","text":"<ul> <li>ui: Fixed custom sanitize/validation configuration being lost on page refresh or report change.</li> </ul>"},{"location":"releases/#205-february-14-2026","title":"2.0.5 - February 14, 2026","text":""},{"location":"releases/#bug-fixes_1","title":"Bug Fixes","text":"<ul> <li>sanitize: Fixed <code>remove_unused_bookmarks</code> incorrectly removing bookmarks from Navigator visuals configured to show \"All\" bookmarks.<ul> <li>Now correctly identifies navigators with missing or empty <code>bookmarkGroup</code> properties as using all bookmarks.</li> </ul> </li> </ul>"},{"location":"releases/#204-january-20-2026","title":"2.0.4 - January 20, 2026","text":""},{"location":"releases/#features_2","title":"Features","text":"<ul> <li>ui: Added \"Select All\" checkbox for Expression Rules in validation panel<ul> <li>Consistent with Actions panel UX pattern</li> <li>Supports indeterminate state when some rules are selected</li> </ul> </li> </ul>"},{"location":"releases/#improvements","title":"Improvements","text":"<ul> <li>cli: Validation summary separator line now dynamically matches text width</li> <li>api: Refactored <code>/validate/run</code> and <code>/validate/run/stream</code> endpoints to use single <code>validate_report</code> call instead of two separate calls<ul> <li>Eliminates duplicate count calculation logic</li> </ul> </li> </ul>"},{"location":"releases/#203-january-17-2026","title":"2.0.3 - January 17, 2026","text":""},{"location":"releases/#features_3","title":"Features","text":"<ul> <li>sanitize: Added <code>exclude_types</code> parameter to page display option actions<ul> <li>Allows excluding specific page types (e.g., \"Tooltip\") when setting display options like \"Fit to Page\"</li> <li>Default configuration now excludes Tooltip pages from display option changes</li> </ul> </li> <li>api: Added <code>failed_rules</code> property to <code>ValidationResult</code> for easy access to unique failed rule names as <code>{rule_id: rule_name}</code></li> </ul>"},{"location":"releases/#bug-fixes_2","title":"Bug Fixes","text":"<ul> <li>api:<ul> <li>Fixed <code>ValidationResult</code> to count unique failed rules by severity, not violation instances. <code>str(result)</code> now shows accurate rule-level counts (e.g., \"3 warnings\" = 3 rules failed, not 38 violation instances)</li> <li>Fixed issue where sanitizer actions were running in validation stream even when excluded (e.g. via UI checkbox)</li> </ul> </li> </ul>"},{"location":"releases/#202-january-17-2026","title":"2.0.2 - January 17, 2026","text":""},{"location":"releases/#features_4","title":"Features","text":"<ul> <li>ui: New web-based UI client (<code>pbir-utils ui</code> or <code>pbir-utils serve</code>)<ul> <li>Report browser for navigating and selecting <code>.Report</code> folders</li> <li>Full wireframe visualization with all existing features</li> <li>Execute sanitize actions with real-time progress streaming (SSE)</li> <li>Run expression rules + sanitize action checks with popup summary</li> <li>Export metadata (CSV) and wireframe (HTML) (respects search, field filters, visibility toggles)</li> <li>Auto-reload wireframe after successful actions</li> <li>Persistent toast notifications and dirty state indicators</li> </ul> </li> <li>validate: New report validation command<ul> <li>Runs sanitizer checks (dry-run) + expression rules by default</li> <li><code>--source all|sanitize|rules</code> to filter which checks to run</li> <li><code>--actions</code> to cherry-pick specific sanitizer actions</li> <li><code>--rules</code> to cherry-pick specific expression rules</li> <li><code>--rules-config</code> and <code>--sanitize-config</code> for custom YAML configs</li> <li><code>--strict</code> mode exits with code 1 on violations (for CI/CD)</li> <li><code>--format json</code> for machine-readable output</li> <li>Output grouped by <code>[Sanitizer Checks]</code> and <code>[Expression Rules]</code> sections</li> </ul> </li> <li>sanitize: Added <code>severity</code> field to action definitions<ul> <li>Actions can now specify <code>severity: error|warning|info</code> in <code>pbir-sanitize.yaml</code></li> <li>Enables per-action violation levels when used with <code>validate</code> command</li> </ul> </li> <li>extract-metadata: Simplified filter arguments<ul> <li>Added explicit <code>--pages</code>, <code>--reports</code>, <code>--tables</code>, <code>--visual-types</code>, and <code>--visual-ids</code> arguments</li> <li>Aligned filter syntax with other CLI commands for bette r ergonomics</li> <li>Updated Python API (<code>export_pbir_metadata_to_csv</code>) with explicit keyword-only parameters</li> <li>Maintained backward compatibility for legacy JSON-based <code>--filters</code></li> </ul> </li> </ul>"},{"location":"releases/#201-january-17-2026","title":"2.0.1 - January 17, 2026","text":""},{"location":"releases/#features_5","title":"Features","text":"<ul> <li>ui: New web-based UI client (<code>pbir-utils ui</code> or <code>pbir-utils serve</code>)<ul> <li>Report browser for navigating and selecting <code>.Report</code> folders</li> <li>Full wireframe visualization with all existing features</li> <li>Execute sanitize actions with real-time progress streaming (SSE)</li> <li>Run expression rules + sanitize action checks with popup summary</li> <li>Export metadata (CSV) and wireframe (HTML) (respects search, field filters, visibility toggles)</li> <li>Auto-reload wireframe after successful actions</li> <li>Persistent toast notifications and dirty state indicators</li> </ul> </li> <li>validate: New report validation command<ul> <li>Runs sanitizer checks (dry-run) + expression rules by default</li> <li><code>--source all|sanitize|rules</code> to filter which checks to run</li> <li><code>--actions</code> to cherry-pick specific sanitizer actions</li> <li><code>--rules</code> to cherry-pick specific expression rules</li> <li><code>--rules-config</code> and <code>--sanitize-config</code> for custom YAML configs</li> <li><code>--strict</code> mode exits with code 1 on violations (for CI/CD)</li> <li><code>--format json</code> for machine-readable output</li> <li>Output grouped by <code>[Sanitizer Checks]</code> and <code>[Expression Rules]</code> sections</li> </ul> </li> <li>sanitize: Added <code>severity</code> field to action definitions<ul> <li>Actions can now specify <code>severity: error|warning|info</code> in <code>pbir-sanitize.yaml</code></li> <li>Enables per-action violation levels when used with <code>validate</code> command</li> </ul> </li> <li>extract-metadata: Simplified filter arguments<ul> <li>Added explicit <code>--pages</code>, <code>--reports</code>, <code>--tables</code>, <code>--visual-types</code>, and <code>--visual-ids</code> arguments</li> <li>Aligned filter syntax with other CLI commands for bette r ergonomics</li> <li>Updated Python API (<code>export_pbir_metadata_to_csv</code>) with explicit keyword-only parameters</li> <li>Maintained backward compatibility for legacy JSON-based <code>--filters</code></li> </ul> </li> </ul>"},{"location":"releases/#190-january-03-2026","title":"1.9.0 - January 03, 2026","text":""},{"location":"releases/#features_6","title":"Features","text":"<ul> <li>wireframe: Major UX overhaul and enhancements<ul> <li>Added Fields Pane with comprehensive data model exploration (tables, columns, measures)</li> <li>Added table tooltips showing field counts, visual usage, and page breakdown</li> <li>Wireframe now opens on the active page instead of first page</li> <li>Page changes tracked in undo stack; reset returns to original active page</li> <li>Enhanced Field usage counts to include fields from Bookmarks, Page-level Filters, and Report-level Filters</li> <li>Added filter toggles to show/hide visible or hidden visuals</li> <li>Implemented universal Reset/Undo functionality</li> <li>Visual improvements for toggle buttons and filter states</li> <li>Modernized UI with glassmorphism, Inter font, and improved interactions</li> <li>Implemented visual layering (Z-index) based on Power BI visual order</li> </ul> </li> <li>extract-metadata: Added \"Attribute Type\" (Column/Measure) to the metadata CSV output</li> </ul>"},{"location":"releases/#bug-fixes_3","title":"Bug Fixes","text":"<ul> <li>sanitize: Improved summary mode messaging<ul> <li>Fixed message grammar for single-report scenarios</li> <li>Actions now show appropriate INFO messages when no changes are needed</li> </ul> </li> <li>extract-metadata: Fixed duplicate rows and missing table names in metadata extraction<ul> <li>Skip redundant <code>queryRef</code>, <code>nativeQueryRef</code>, <code>metadata</code>, and <code>Subquery</code> keys</li> <li>Prevents duplicate entries from qualified name references</li> <li>Prevents orphan rows from filter subqueries with unresolved table aliases</li> </ul> </li> </ul>"},{"location":"releases/#180-january-01-2026","title":"1.8.0 - January 01, 2026","text":""},{"location":"releases/#cli-features","title":"CLI Features","text":"<ul> <li>visualize: Major overhaul to static HTML generation (removed Dash server)<ul> <li>Lightweight, portable HTML output</li> <li>Interactive Features:<ul> <li>Search/Filter visuals by ID, Type, or Page Name</li> <li>Copy Visual ID (left-click)</li> <li>Hide/Unhide visuals (right-click) with Undo/Reset</li> <li>Hide/Unhide pages (right-click tabs) with restore pill</li> </ul> </li> <li>UI Enhancements:<ul> <li>\ud83c\udf19 Dark mode toggle with preference persistence</li> <li>\ud83d\udd0d Zoom controls (25%-200%) for large reports</li> <li>\ud83d\udcca Visual count badges on page tabs</li> <li>\ud83d\udccf Dimension tooltips (page size, visual size/position)</li> <li>Page tooltips with visual type breakdown on hover</li> <li>Visual indicators for hidden pages/visuals</li> <li>Refined Fluent-like styling</li> </ul> </li> </ul> </li> </ul>"},{"location":"releases/#171-december-31-2025","title":"1.7.1 - December 31, 2025","text":""},{"location":"releases/#cli-features_1","title":"CLI Features","text":"<ul> <li>batch-update: Added <code>--summary</code> flag to display aggregated output instead of per-file messages</li> </ul>"},{"location":"releases/#documentation","title":"Documentation","text":"<ul> <li>UI Improvements<ul> <li>Enhanced documentation site with instant navigation (SPA-like), sticky Table of Contents, and navigation tracking</li> <li>Modernized UI with custom CSS: bold/underlined active tabs, refined fonts (Inter/JetBrains Mono), and smoother transitions</li> <li>Updated <code>README.md</code> and documentation home page with improved formatting and emoji indicators for better readability</li> <li>Hidden left navigation sidebar on all pages for more content space</li> </ul> </li> <li>Release Notes<ul> <li>Added auto-generated Release Notes page that fetches full release history from GitHub Releases API</li> </ul> </li> </ul>"},{"location":"releases/#170-december-24-2025","title":"1.7.0 - December 24, 2025","text":""},{"location":"releases/#added","title":"Added","text":"<ul> <li>Visual Metadata Extraction<ul> <li>Added <code>--visuals-only</code> flag to <code>extract-metadata</code> command for visual-level metadata export</li> <li>Exports Visual Type, Visual ID, Parent Group ID, and Is Hidden status</li> <li>Made output path optional - defaults to <code>metadata.csv</code> or <code>visuals.csv</code> in the report folder</li> </ul> </li> </ul>"},{"location":"releases/#documentation_1","title":"Documentation","text":"<ul> <li>CI/CD Guide<ul> <li>Added GitHub Actions workflow example alongside Azure DevOps</li> <li>Made validation script platform-agnostic (auto-detects CI environment)</li> </ul> </li> <li>Examples Cleanup<ul> <li>Removed deprecated <code>examples/example_usage.ipynb</code> notebook as all examples are fully covered in the official documentation</li> <li>Cleansed references to the notebook from <code>README.md</code> and documentation files</li> </ul> </li> </ul>"},{"location":"releases/#167-december-21-2025","title":"1.6.7 - December 21, 2025","text":""},{"location":"releases/#added_1","title":"Added","text":"<ul> <li>Project Identity<ul> <li>Added official project logo to README and Documentation.</li> <li>Added ASCII art startup banner to CLI for better user experience.</li> </ul> </li> </ul>"},{"location":"releases/#documentation_2","title":"Documentation","text":"<ul> <li>CI/CD Integration<ul> <li>Added new \"CI/CD Integration\" guide covering Azure DevOps pipeline setup</li> <li>Added comprehensive validation script example with blocking rules configuration</li> <li>Included strict validation strategy (fail build vs warn) guidance</li> </ul> </li> </ul>"},{"location":"releases/#166-december-20-2025","title":"1.6.6 - December 20, 2025","text":""},{"location":"releases/#performance","title":"Performance","text":"<ul> <li>High-Impact Optimizations:<ul> <li>Bookmark Usage Check: Drastically improved speed of checking for unused bookmarks by scanning visuals in a single efficient pass.</li> <li>Invalid Bookmark Cleanup: Significantly faster cleanup process by pre-loading valid visual data instead of repeated file checks.</li> <li>Hidden Visuals Removal: Reduced file operations by 50% by merging duplicate scanning processes.</li> <li>Metadata Extraction: Exponential speedup for large reports by optimizing how metadata expressions are matched and deduplicated.</li> </ul> </li> </ul>"},{"location":"releases/#changed","title":"Changed","text":"<ul> <li>CLI: All commands now consistently support auto-detection of report path when running from inside a <code>.Report</code> folder (<code>batch-update</code> and <code>update-filters</code> were updated)</li> </ul>"},{"location":"releases/#documentation_3","title":"Documentation","text":"<ul> <li>CLI Reference<ul> <li>Added comprehensive \"Available Actions\" table documenting all 22 sanitization actions with descriptions</li> <li>Added \"Default\" column to action table showing which actions run by default vs. opt-in with <code>--include</code></li> <li>Added tips for config auto-discovery and report path auto-detection</li> </ul> </li> </ul>"},{"location":"releases/#165-december-20-2025","title":"1.6.5 - December 20, 2025","text":""},{"location":"releases/#performance_1","title":"Performance","text":"<ul> <li>Remove Measures: Significantly improved performance for reports with many measures by pre-computing visual usage and dependency graphs in a single pass instead of walking the file system for each measure</li> </ul>"},{"location":"releases/#fixed_2","title":"Fixed","text":"<ul> <li>Sanitize Command: Now raises an error when <code>--config</code> path doesn't exist, instead of silently falling back to defaults</li> <li>Visualize Command: Fixed crash when a page has no visuals (empty legend labels) and prevented duplicate startup messages</li> </ul>"},{"location":"releases/#removed","title":"Removed","text":"<ul> <li>CLI: Removed the redundant <code>--error-on-change</code> option from all commands (functionality can be achieved by checking <code>--dry-run</code> output)</li> </ul>"},{"location":"releases/#161-december-13-2025","title":"1.6.1 - December 13, 2025","text":""},{"location":"releases/#updated","title":"Updated","text":"<ul> <li>Clear Filters</li> <li>Added <code>--summary</code> option for concise count-based output</li> <li>Improved slicer detection to match all slicer types</li> </ul>"},{"location":"releases/#160-december-13-2025","title":"1.6.0 - December 13, 2025","text":""},{"location":"releases/#added_2","title":"Added","text":"<ul> <li>Set Display Option Command: New <code>set-display-option</code> CLI command and <code>set_page_display_option()</code> Python API to set page display options in Power BI reports.</li> <li>Supports three display options: <code>ActualSize</code>, <code>FitToPage</code>, <code>FitToWidth</code></li> <li>Target specific pages by <code>displayName</code> or internal <code>name</code></li> <li>Apply to all pages when no filter specified</li> <li>Sanitize actions: <code>set_display_option_fit_to_page</code>, <code>set_display_option_fit_to_width</code>, <code>set_display_option_actual_size</code></li> <li>Clear Filters Command: New <code>clear-filters</code> CLI command and <code>clear_filters()</code> Python API to inspect and clear filter conditions from Power BI reports.</li> <li>Supports report, page, and visual level filters (including slicers)</li> <li>Filter targeting with <code>--page</code>, <code>--visual</code> options</li> <li>Field filtering with <code>--table</code>, <code>--column</code>, <code>--field</code> (supports wildcards like <code>Date*</code>, <code>*Amount</code>)</li> <li>Dry-run mode (<code>--dry-run</code>) for inspecting filters without modifying files</li> <li>Configurable via <code>pbir-sanitizer.yaml</code> for use in sanitization pipelines</li> </ul>"},{"location":"releases/#157-december-09-2025","title":"1.5.7 - December 09, 2025","text":""},{"location":"releases/#performance_2","title":"Performance","text":"<ul> <li>CLI Startup Optimization: Reduced <code>--help</code> command time from ~10 seconds to under 1 second (~15x faster) by implementing lazy imports for heavy dependencies and deferring module loading until commands are executed.</li> </ul>"},{"location":"releases/#fixed_3","title":"Fixed","text":"<ul> <li>Wireframe Visualizer Coordinate Parsing: Fixed <code>TypeError</code> and <code>ValueError</code> in <code>display_report_wireframes</code> caused by coordinates being stored as strings or with <code>@@__PRESERVE_FLOAT__@@</code> prefixes.</li> </ul>"},{"location":"ui/","title":"PBIR-Utils UI","text":"<p>The PBIR-Utils UI visualizes Power BI reports, explores their structure, and runs cleanup actions. It launches in your default browser.</p>"},{"location":"ui/#launch","title":"Launch","text":"<p>Start the UI from your terminal:</p> <pre><code># Open for the current directory\npbir-utils ui\n\n# Open a specific report\npbir-utils ui \"C:\\Reports\\Sales.Report\"\n\n# Use a specific port\npbir-utils ui --port 9000\n\n# Start without opening the browser\npbir-utils ui --no-browser\n</code></pre>"},{"location":"ui/#options","title":"Options","text":"Option Description <code>report_path</code> Path to auto-open (optional; defaults to finding a <code>.Report</code> in CWD) <code>--port</code> Port to bind to (default: 8765) <code>--host</code> Host to bind to (default: 127.0.0.1) <code>--no-browser</code> Don't open the browser automatically"},{"location":"ui/#browsing-viewing","title":"Browsing &amp; Viewing","text":"<p>The UI provides a wireframe view of your report layout.</p> <ul> <li>Navigation: Use the sidebar to browse your file system and open <code>.Report</code> folders.</li> <li>Search: Use the main search bar in the header to filter the view. You can search by:<ul> <li>Visuals: Filter by unique ID or visual type (e.g., <code>slicer</code>).</li> <li>Pages: Filter by display name or page ID. Entering a page ID will narrow the tab bar to only that page.</li> </ul> </li> <li>Canvas: The center area shows your report visuals. Zoom in or out using the controls in the top-right.</li> <li>Tabs: Switch pages at the top. Right-click a tab to Copy Page Name, Copy Page ID, or Hide Page.</li> <li>Dark Mode: Toggle the \ud83c\udf19 icon in the header.</li> <li>Panes: You can resize the sidebar and the output panel by dragging their edges.</li> <li>Active States: Zoom levels and theme preferences are saved to your local storage across sessions.</li> </ul>"},{"location":"ui/#interacting-with-visuals","title":"Interacting with Visuals","text":"<p>Click visuals to select them. Hold <code>Ctrl</code> (or <code>Cmd</code>) to select multiple, or click and drag to draw a selection box.</p> <p>Right-click any visual (or selection) to:</p> <ul> <li>Copy ID: Get the visual's unique ID.</li> <li>Hide Visual: Temporarily remove it from the wireframe.</li> </ul>"},{"location":"ui/#hiding-restoring","title":"Hiding &amp; Restoring","text":"<p>You can hide visuals or pages to declutter the view.</p> <ul> <li>Undo: Restores the last hidden item.</li> <li>Reset: Restores everything.</li> <li>Hidden Pills: The header shows pills like <code>+3 hidden</code> if items are hidden. Clicking a pill unhides all items of that type immediately.</li> </ul>"},{"location":"ui/#data-model","title":"Data Model","text":"<p>The Fields Pane (right side) lists your tables, columns, and measures.</p> <ul> <li>Search: Find fields by name.</li> <li>Field Usage: Hover over a field to see where it is used (visuals, bookmarks, filters).</li> <li>Fields Selection: Click a field to select it (and deselect others). Hold <code>Ctrl</code> (or <code>Cmd</code>) to select multiple fields.</li> <li>Filter by Field: Selected fields highlight the visuals that use them.</li> <li>Selection Controls: A summary of selected fields appears at the top of the pane, allowing you to quickly clear the selection.</li> </ul>"},{"location":"ui/#actions-validation","title":"Actions &amp; Validation","text":""},{"location":"ui/#running-actions","title":"Running Actions","text":"<p>The Actions panel lists available cleanup tasks.</p> <ul> <li>Run: Executes the selected actions.</li> <li>Dry Run: Simulates the actions and prints a log of what would happen, without changing files.</li> <li>Load Config: Click the \"\ud83d\udcc4\" button to upload a custom <code>pbir-rules.yaml</code> or <code>pbir-sanitize.yaml</code> to override default action behaviors.</li> </ul>"},{"location":"ui/#validation","title":"Validation","text":"<p>The Validate panel checks your report against rules.</p> <ul> <li>Expression Rules: Checks logic (e.g., \"Visuals must not overlap\").</li> <li>Sanitizer Checks: If \"Include sanitizer action checks\" is selected, it also checks if any sanitizer actions (like \"Remove unused bookmarks\") would trigger changes.</li> <li>Load Rules: You can upload a custom <code>pbir-rules.yaml</code> here.</li> </ul>"},{"location":"ui/#exporting","title":"Exporting","text":"<p>You can export data for external use:</p> <ul> <li>Attributes CSV: Metadata for visible visuals.</li> <li>Visuals CSV: List of visuals with IDs and types.</li> <li>Wireframe HTML: Generates a standalone HTML file of the current view that you can share.</li> </ul>"},{"location":"ui/#static-wireframes","title":"Static Wireframes","text":"<p>If you just need a portable file to share with colleagues, you can generate a static wireframe. This contains the same rich visualization but as a standalone file.</p>"},{"location":"ui/#cli-export","title":"CLI Export","text":"<p>You can also generate the standalone wireframe from the command line:</p> <pre><code>pbir-utils visualize \"C:\\Reports\\Sales.Report\"\n</code></pre> <p>Options:</p> <ul> <li><code>--pages</code>: Filter by page name or ID.</li> <li><code>--visual-types</code>: Filter by type (e.g., <code>slicer</code>).</li> <li><code>--visual-ids</code>: Filter by specific IDs.</li> <li><code>--no-show-hidden</code>: Exclude hidden visuals from the output.</li> </ul>"}]}